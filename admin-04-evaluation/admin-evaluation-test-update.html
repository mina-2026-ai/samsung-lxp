<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../common-style.css">
    <link rel="stylesheet" href="../sidebar-style.css">
    <link rel="stylesheet" href="../btn-style.css">
    
    <script src="../sidebar-function.js" defer></script>
    <script src="../common-funtion.js" defer></script>
    <title>Samsung Academy LXP - ê´€ë¦¬ì</title>
    <style>
        /* ì¶”ê°€ì ì¸ í˜ì´ì§€ë³„ ìŠ¤íƒ€ì¼ì€ ì—¬ê¸°ì— ì‘ì„± */
    </style>
</head>
<body>
    <!-- ìƒë‹¨ í—¤ë” -->
    <header class="header">
        <h1>í‰ê°€ ê´€ë¦¬ > ì‹œí—˜ ê´€ë¦¬ > ì‹œí—˜ ë°°ì •</h1>
        <!-- icon -->
        <div class="icon-container">
            <div class="icon-box"><img src="/icons/bell.svg" alt="alert icon" style="width: 28px;"></div>
            <div class="icon-box" onClick="location.href='../admin-00-topmenu/admin-topmenu-user.html'"><img src="/icons/user.svg" alt="user icon" style="width: 30px;"></div>
            <div class="icon-box"><img src="/icons/setting.svg" alt="setting icon" style="width: 25px;"></div>
        </div>
    </header>

    <!-- ì™¼ìª½ ì‚¬ì´ë“œë°” -->
    <aside class="sidebar">
        <!-- ì‚¬ì´ë“œë°” ë©”ë‰´ ë‚´ìš© -->

        <!-- logo-box -->
        <div class="logo-box">
            <img id="sidebarLogo" src="/logo-white.png" alt="logo" style="width: 130px;">
        </div>

        <!-- menu -->
        <nav class="menu">
            <ul>
                <li data-page="../admin-01-dashboard/admin-dashboard.html" onclick="handleMenuClick(this, '../admin-01-dashboard/admin-dashboard.html')">
                    <img src="../icons/01-dashboard.svg" alt="dashboard icon" style="width: 26px; margin-left:-2px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">í˜„í™©(ëŒ€ì‹œë³´ë“œ)</span>
                </li>
                <li data-page="../admin-02-user/admin-user-trainee.html" onclick="handleMenuClick(this, '../admin-02-user/admin-user-trainee.html')">
                    <img src="../icons/02-user.svg" alt="user icon" style="width: 28px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ì‚¬ìš©ì ê´€ë¦¬</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-02-user/admin-user-trainee.html'">í›ˆë ¨ìƒ ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-02-user/admin-user-instructor.html'">ê°•ì‚¬ ê´€ë¦¬</li>
                         <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-02-user/admin-user.html'">ê´€ë¦¬ì ê´€ë¦¬</li>
                    </ul>
                </li>
                <li data-page="../admin-04-evaluation/admin-evaluation-question-bank.html" onclick="handleMenuClick(this, '../admin-04-evaluation/admin-evaluation-question-bank.html')">
                    <img src="../icons/03-description.svg" alt="evaluation icon" style="width: 26px; margin-left:0px; margin-right: 7px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ì½˜í…ì¸  ê´€ë¦¬</span>
                </li>
                <li data-page="../admin-03-courses/admin-course-edu.html" onclick="handleMenuClick(this, '../admin-03-courses/admin-courses-edu.html')">
                    <img src="../icons/03-course.svg" alt="course icon" style="width: 25px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ê³¼ì •/ìš´ì˜ ê´€ë¦¬</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-03-courses/admin-courses-edu.html'">ê³¼ì • ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-03-courses/admin-courses-schedule.html'">ì¼ì • ê´€ë¦¬</li>
                    </ul>
                </li>
                <li data-page="../admin-04-evaluation/admin-evaluation-assignment.html" onclick="handleMenuClick(this, '../admin-04-evaluation/admin-evaluation-assignment.html')">
                    <img src="../icons/04-evaluation.svg" alt="evaluation icon" style="width: 30px; margin-left:-4px; margin-right: 7px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text active_menu">í‰ê°€ ê´€ë¦¬</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-04-evaluation/admin-evaluation-assignment.html'">ê³¼ì œ ë°°ì • ë° ì±„ì </li>
                        <li class="submenu active_menu" onclick="event.stopPropagation(); location.href='../admin-04-evaluation/admin-evaluation-test.html'">ì‹œí—˜ ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-04-evaluation/admin-evaluation-result.html'">ì‹œí—˜ ë°°ì • ë° ì±„ì </li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-04-evaluation/admin-evaluation-monitoring.html'">í‰ê°€ ëª¨ë‹ˆí„°ë§</li>
                    </ul>
                </li>
                <li data-page="../admin-05-attendance/admin-attendance.html" onclick="handleMenuClick(this, '../admin-05-attendance/admin-attendance.html')">
                    <img src="../icons/05-attendance.svg" alt="attendance icon" style="width: 28px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ì¶œê²°/ì´ìˆ˜ ê´€ë¦¬</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-05-attendance/admin-attendance.html'">ì¶œê²°í˜„í™©</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-05-attendance/admin-attendance-graduate.html'">ì´ìˆ˜ ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-05-attendance/admin-attendance-survey.html'">ì„¤ë¬¸ì¡°ì‚¬ ê´€ë¦¬</li>
                    </ul>
                </li>
                <li data-page="../admin-06-support/admin-support-tutoring.html" onclick="handleMenuClick(this, '../admin-06-support/admin-support-tutoring.html')">
                    <img src="../icons/06-support.svg" alt="support icon" style="width: 25px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">í•™ìŠµ ì§€ì›</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-06-support/admin-support-tutoring.html'">íŠœí„°ë§/Q&A</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-06-support/admin-support-response.html'">ì‘ë‹µí˜„í™©</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-06-support/admin-support-chat-monitoring.html'">ì±„íŒ… ëª¨ë‹ˆí„°ë§</li>
                    </ul>
                </li>
                <li data-page="../admin-07-notice/admin-notice.html" onclick="handleMenuClick(this, '../admin-07-notice/admin-notice.html')" class="white-icon">
                    <img src="../icons/bell.svg" alt="notice icon" style="width: 26px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ê³µì§€/ì•Œë¦¼</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-07-notice/admin-notice.html'">ê³µì§€ ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-07-notice/admin-alarm.html'">ì•Œë¦¼ ê´€ë¦¬</li>
                    </ul>
                </li>
            </ul>
        </nav>
        <span class="logout" onclick="location.href='../01-login/login.html'">ë¡œê·¸ì•„ì›ƒ 
            <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px" fill="CurrentColor">
                <path d="M186.67-120q-27 0-46.84-19.83Q120-159.67 120-186.67v-586.66q0-27 19.83-46.84Q159.67-840 186.67-840h292.66v66.67H186.67v586.66h292.66V-120H186.67Zm470.66-176.67-47-48 102-102H360v-66.66h351l-102-102 47-48 184 184-182.67 182.66Z"/>
            </svg>
        </span>
    </aside>
    </aside>

    <!-- í† ê¸€ ë²„íŠ¼ -->
    <div class="toggle-btn" onclick="toggleSidebar()">
        â—€
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <main class="main-content">
        <!-- í›ˆë ¨ìƒ ê´€ë¦¬ -->
        <section class="main-content-inner">
            <div class="test-create-container" style="max-width:800px;background:#fff;border-radius:12px;padding:36px 32px 32px 32px;border: 1px solid var(--color-line-gray);">
                <div class="section-title" style="font-size:22px;font-weight:700;margin-bottom:18px;color:#1a1a1a;">ì‹œí—˜ ìˆ˜ì •í•˜ê¸°</div>
                <form id="testForm">
                    <div style="display:flex;gap:24px;margin-bottom:18px;">
                        <div style="flex:1;display:flex;flex-direction:column;gap:6px;">
                            <label style="font-size:15px;font-weight:600;color:#333;" for="testName">ì‹œí—˜ëª…</label>
                            <input type="text" class="form-input" id="testName" name="testName" required>
                        </div>
                        <div style="flex:1;display:flex;flex-direction:column;gap:6px;">
                            <label style="font-size:15px;font-weight:600;color:#333;" for="testType">ìœ í˜•</label>
                            <select class="form-select" id="testType" name="testType">
                                <option value="ë‹¨ìœ„ì‹œí—˜">ë‹¨ìœ„ì‹œí—˜</option>
                                <option value="ì¤‘ê°„ê³ ì‚¬">ì¤‘ê°„ê³ ì‚¬</option>
                                <option value="ê¸°ë§ê³ ì‚¬">ê¸°ë§ê³ ì‚¬</option>
                            </select>
                        </div>
                    </div>
                    <div style="display:flex;gap:24px;margin-bottom:18px;">
                        <div style="flex:1;display:flex;flex-direction:column;gap:6px;">
                            <label style="font-size:15px;font-weight:600;color:#333;" for="timeLimit">ì œí•œì‹œê°„ (ë¶„)</label>
                            <input type="number" class="form-input" id="timeLimit" name="timeLimit" min="1" value="60">
                        </div>
                        <div style="flex:1;display:flex;flex-direction:column;gap:6px;">
                            <label style="font-size:15px;font-weight:600;color:#333;" for="passScore">í•©ê²©ì ìˆ˜</label>
                            <input type="number" class="form-input" id="passScore" name="passScore" min="0" max="100" value="70">
                        </div>
                        <div style="flex:1;display:flex;align-items:center;gap:8px;margin-top:28px;">
                            <input type="checkbox" id="randomOrder" name="randomOrder" checked>
                            <label for="randomOrder" style="font-size:15px;">ëœë¤ì¶œì œ ì‚¬ìš©</label>
                        </div>
                    </div>
                    <!-- ìˆ˜ë™ ë¬¸ì œ ì¶”ê°€ ì˜ì—­ (ëœë¤ì¶œì œ ë¯¸ì‚¬ìš© ì‹œ í‘œì‹œ) -->
                    <div style="border-top:1.5px solid #e0e0e0;margin:32px 0 24px 0;"></div>
                    <!-- ì‹œí—˜ êµ¬ì„±(ìˆ˜ë™ ë¬¸ì œ ì¶”ê°€) ì˜ì—­ -->
                    <div id="manualQuestionArea" style="margin-bottom:24px;">
                        <div style="display:flex;align-items:center;gap:16px; margin-bottom:10px;">
                            <span style="font-size:16px;font-weight:600;">ì‹œí—˜ êµ¬ì„±</span>
                                <button type="button" class="btn btn-add" id="addManualQuestionBtn">ë¬¸ì œ ì¶”ê°€</button>
                                <!-- ë¬¸ì œ ê²€ìƒ‰ ëª¨ë‹¬ -->
                                <div id="questionModal" class="modal" style="display:none;position:fixed;z-index:9999;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.25);align-items:center;justify-content:center;">
                                    <div class="modal-content" style="background:#fff;padding:32px 28px 24px 28px;border-radius:12px;max-width:800px;width:95vw;box-shadow:0 2px 16px rgba(0,0,0,0.12);position:relative;">
                                        <span class="close" id="closeQuestionModal" style="position:absolute;top:18px;right:22px;font-size:22px;cursor:pointer;">&times;</span>
                                        <h2 style="font-size:20px;font-weight:700;margin-bottom:18px;">ë¬¸ì œ ê²€ìƒ‰</h2>
                                        <form id="questionSearchForm" style="margin-bottom:18px;display:flex;flex-direction:column;gap:12px;">
                                            <div style="display:flex;gap:12px;">
                                                <select id="category1" required style="flex:1;padding:6px 10px;font-size:15px;">
                                                    <option value="">ëŒ€ë¶„ë¥˜ ì„ íƒ*</option>
                                                    <option value="Python">Python</option>
                                                    <option value="JavaScript">JavaScript</option>
                                                    <option value="Java">Java</option>
                                                </select>
                                                <select id="category2" style="flex:1;padding:6px 10px;font-size:15px;">
                                                    <option value="">ì¤‘ë¶„ë¥˜ ì„ íƒ</option>
                                                </select>
                                                <select id="category3" style="flex:1;padding:6px 10px;font-size:15px;">
                                                    <option value="">ì†Œë¶„ë¥˜ ì„ íƒ</option>
                                                </select>
                                            </div>
                                            <div style="display:flex;gap:12px;align-items: center;">
                                                <input type="text" id="searchTitle" placeholder="ì œëª©" style="flex:1;padding:6px 10px;font-size:15px;">
                                                <button type="submit" class="btn btn-search">ê²€ìƒ‰</button>
                                            </div>
                                        </form>
                                        <div id="questionList" style="min-height:120px;margin-bottom:18px;"></div>
                                        <div id="questionPagination" style="display:flex;justify-content:center;gap:6px;"></div>
                                    </div>
                                </div>
                        </div>
                        <div id="manualQuestionList">
                            <!-- ìˆ˜ë™ ì¶”ê°€ëœ ë¬¸ì œ ë¦¬ìŠ¤íŠ¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤. -->
                        </div>
                    </div>
                    <div id="manualQuestionArea" style="display:none; margin-bottom:24px;">
                        <div style="display:flex;align-items:center;gap:16px; margin-bottom:10px;">
                            <span style="font-size:16px;font-weight:600;">ìˆ˜ë™ ë¬¸ì œ ì¶”ê°€</span>
                            <button type="button" class="btn btn-add" id="addManualQuestionBtn">ë¬¸ì œ ì¶”ê°€</button>
                        </div>
                        <div id="manualQuestionList">
                            <!-- ìˆ˜ë™ ì¶”ê°€ëœ ë¬¸ì œ ë¦¬ìŠ¤íŠ¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤. -->
                        </div>
                    </div>
                    <div id="ruleSection">
                        <div class="section-title" style="font-size:18px;margin-bottom:10px;">ğŸ“š ë¬¸ì œ ì¶œì œ ê·œì¹™</div>
                        <div class="rule-list" id="ruleList" style="margin-bottom:12px;"></div>
                        <button type="button" class="btn btn-add" id="addRuleBtn">â• ê·œì¹™ ì¶”ê°€</button>
                        <!-- ê·œì¹™ ì¶”ê°€ ëª¨ë‹¬ -->
                        <div id="addRuleModal" class="modal" style="display:none;position:fixed;z-index:9999;left:var(--sidebar-width);top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.25);align-items:center;justify-content:center;">
                            <div class="modal-content" style="background:#fff;padding:32px 28px 24px 28px;border-radius:12px;max-width:800px;width:95vw;box-shadow:0 2px 16px rgba(0,0,0,0.12);position:relative;">
                                <span class="close" id="closeAddRuleModal" style="position:absolute;top:18px;right:22px;font-size:22px;cursor:pointer;">&times;</span>
                                <h2 style="font-size:20px;font-weight:700;margin-bottom:18px;">ê·œì¹™ ì¶”ê°€</h2>
                                <form id="addRuleForm" style="display:flex;flex-direction:column;gap:14px;">
                                    <label>ëŒ€ë¶„ë¥˜</label>
                                    <select id="addRuleSubject" required class="form-input">
                                        <option value="">ëŒ€ë¶„ë¥˜ ì„ íƒ*</option>
                                        <option value="Python">Python</option>
                                        <option value="JavaScript">JavaScript</option>
                                        <option value="Java">Java</option>
                                    </select>
                                    <label>ì¤‘ë¶„ë¥˜</label>
                                    <select id="addRuleTopic" class="form-input">
                                        <option value="">ì¤‘ë¶„ë¥˜ ì„ íƒ</option>
                                    </select>
                                    <label>ì†Œë¶„ë¥˜</label>
                                    <select id="addRuleSubtopic" class="form-input">
                                        <option value="">ì†Œë¶„ë¥˜ ì„ íƒ</option>
                                    </select>
                                    <div>
                                        <label>ë‚œì´ë„</label>
                                        <div style="display:flex;gap:8px;">
                                            <select id="addRuleDifficultyLevel1" class="form-input">
                                                <option value="">ë‚œì´ë„ ì„ íƒ</option>
                                                <option value="Easy">Easy</option>
                                                <option value="Medium">Medium</option>
                                                <option value="Hard">Hard</option>
                                            </select>
                                            <input type="number" id="addRuleDifficultyCount1" class="form-input" min="0" placeholder="ê°œìˆ˜">
                                            <select id="addRuleDifficultyLevel2" class="form-input">
                                                <option value="">ë‚œì´ë„ ì„ íƒ</option>
                                                <option value="Easy">Easy</option>
                                                <option value="Medium">Medium</option>
                                                <option value="Hard">Hard</option>
                                            </select>
                                            <input type="number" id="addRuleDifficultyCount2" class="form-input" min="0" placeholder="ê°œìˆ˜">
                                            <select id="addRuleDifficultyLevel3" class="form-input">
                                                <option value="">ë‚œì´ë„ ì„ íƒ</option>
                                                <option value="Easy">Easy</option>
                                                <option value="Medium">Medium</option>
                                                <option value="Hard">Hard</option>
                                            </select>
                                            <input type="number" id="addRuleDifficultyCount3" class="form-input" min="0" placeholder="ê°œìˆ˜">
                                        </div>
                                    </div>
                                    <div>
                                        <label>íƒœê·¸</label>
                                        <input type="text" id="addRuleTags" class="form-input" placeholder="ì˜ˆ: iteration">
                                    </div>
                                    <div>
                                        <label>ì´ ë¬¸í•­ìˆ˜</label>
                                        <input type="number" id="addRuleCount" class="form-input" min="1" disabled>
                                    </div>
                                    <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
                                        <button type="button" class="btn btn-gray" id="cancelAddRule">ì·¨ì†Œ</button>
                                        <button type="submit" class="btn btn-save">ì¶”ê°€</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div style="border-top:1.5px solid #e0e0e0;margin:32px 0 24px 0;"></div>
                    <div style="display:flex;align-items:center;gap:18px;font-size:16px;margin-bottom:8px;">
                        <span>ğŸ‘‰ í˜„ì¬ ì´ ë¬¸í•­ ìˆ˜: <span id="currentCount">10</span> / <span id="maxCount">20</span></span>
                        <span style="color:#e67e22;font-size:15px;">âš  Loop/for Hard ë¬¸ì œ ë¶€ì¡± (2ê°œë§Œ ì¡´ì¬)</span>
                    </div>
                    <div style="border-top:1.5px solid #e0e0e0;margin:32px 0 24px 0;"></div>
                    <div style="margin-bottom:18px;">
                        <div style="display:flex;align-items:center;gap:18px;margin-bottom:10px;">
                            <input type="checkbox" id="autoScore" name="autoScore" checked>
                            <label for="autoScore">ìë™ ê· ë“±ë°°ë¶„</label>
                            <span>ë˜ëŠ” ìˆ˜ë™:</span>
                            <label for="manualScore">ë¬¸í•­ë‹¹:</label>
                            <input type="number" class="form-input" id="manualScore" name="manualScore" value="5" min="1" style="width:70px;">
                            <span>ì </span>
                        </div>
                    </div>
                    <div style="border-top:1.5px solid #e0e0e0;margin:32px 0 24px 0;"></div>
                    <div class="section-title" style="font-size:18px;margin-bottom:10px;">ğŸ‘€ ì‹œí—˜ ë¯¸ë¦¬ë³´ê¸°</div>
                    <button type="button" class="btn btn-preview" id="previewBtn">ëœë¤ ìƒ˜í”Œ ìƒì„±</button>
                    <div style="border-top:1.5px solid #e0e0e0;margin:32px 0 24px 0;"></div>
                </form>
                <div style="display:flex;gap:16px;justify-content:flex-end;margin-top:30px;">
                    <button type="submit" class="btn btn-save">ì €ì¥</button>
                </div>
            </div>
    </main>

    <script>
        // ë‚œì´ë„ ê°œìˆ˜ ë³€ê²½ ì‹œ ì´ ë¬¸í•­ìˆ˜ ìë™ ê³„ì‚°
        function updateRuleCount() {
            const c1 = parseInt(document.getElementById('addRuleDifficultyCount1').value) || 0;
            const c2 = parseInt(document.getElementById('addRuleDifficultyCount2').value) || 0;
            const c3 = parseInt(document.getElementById('addRuleDifficultyCount3').value) || 0;
            document.getElementById('addRuleCount').value = c1 + c2 + c3;
        }
        document.addEventListener('DOMContentLoaded', function() {
            // DBì—ì„œ ë°›ì•„ì˜¨ ë”ë¯¸ë°ì´í„° (ìˆ˜ì •ìš©)
            const testData = {
                testName: 'JavaScript ì¤‘ê¸‰ ë¬¸ë²• í‰ê°€',
                testType: 'ì¤‘ê°„ê³ ì‚¬',
                timeLimit: 60,
                passScore: 70,
                randomOrder: true,
                manualQuestions: ['ìë°”ìŠ¤í¬ë¦½íŠ¸ ì´ë²¤íŠ¸ ìœ„ì„', 'ES6 í™”ì‚´í‘œ í•¨ìˆ˜', 'DOM ì¡°ì‘'],
                rules: [
                    {
                        subject: 'JavaScript',
                        topic: 'ES6',
                        subtopic: 'let, arrow',
                        difficulty: { Easy: 3, Medium: 2 },
                        tags: 'es6, arrow',
                        count: 5
                    },
                    {
                        subject: 'JavaScript',
                        topic: 'DOM',
                        subtopic: 'ì„ íƒì, ì¡°ì‘',
                        difficulty: { Medium: 2, Hard: 2 },
                        tags: 'dom, selector',
                        count: 4
                    },
                    {
                        subject: 'JavaScript',
                        topic: 'ì´ë²¤íŠ¸',
                        subtopic: 'í´ë¦­',
                        difficulty: { Easy: 1 },
                        tags: 'event',
                        count: 1
                    }
                ],
                autoScore: false,
                manualScore: 7,
                currentCount: 10,
                maxCount: 15
            };
            ['addRuleDifficultyCount1','addRuleDifficultyCount2','addRuleDifficultyCount3'].forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.addEventListener('input', updateRuleCount);
                }
            });
        });
        // ê·œì¹™ ì¶”ê°€ ëª¨ë‹¬ ë‚´ select ì—°ë™
        const addRuleCategory2Options = {
            'Python': ['ê¸°ì´ˆ', 'ë¬¸ë²•', 'í•¨ìˆ˜', 'ë°˜ë³µë¬¸'],
            'JavaScript': ['ê¸°ì´ˆ', 'ES6', 'DOM', 'ì´ë²¤íŠ¸'],
            'Java': ['ê¸°ì´ˆ', 'OOP', 'ì»¬ë ‰ì…˜', 'ìŠ¤ë ˆë“œ']
        };
        const addRuleCategory3Options = {
            'ê¸°ì´ˆ': ['ë³€ìˆ˜', 'ìë£Œí˜•'],
            'ë¬¸ë²•': ['if', 'for', 'while'],
            'í•¨ìˆ˜': ['ì •ì˜', 'í˜¸ì¶œ'],
            'ë°˜ë³µë¬¸': ['for', 'while'],
            'ES6': ['let', 'arrow'],
            'DOM': ['ì„ íƒì', 'ì¡°ì‘'],
            'ì´ë²¤íŠ¸': ['í´ë¦­', 'ì…ë ¥'],
            'OOP': ['ìƒì†', 'ë‹¤í˜•ì„±'],
            'ì»¬ë ‰ì…˜': ['List', 'Map'],
            'ìŠ¤ë ˆë“œ': ['ìƒì„±', 'ë™ê¸°í™”']
        };
        
        document.addEventListener('DOMContentLoaded', function() {
            const subjectSel = document.getElementById('addRuleSubject');
            const topicSel = document.getElementById('addRuleTopic');
            const subtopicSel = document.getElementById('addRuleSubtopic');
            if (subjectSel && topicSel && subtopicSel) {
                subjectSel.addEventListener('change', function() {
                    topicSel.innerHTML = '<option value="">ì¤‘ë¶„ë¥˜ ì„ íƒ</option>';
                    subtopicSel.innerHTML = '<option value="">ì†Œë¶„ë¥˜ ì„ íƒ</option>';
                    if (addRuleCategory2Options[subjectSel.value]) {
                        addRuleCategory2Options[subjectSel.value].forEach(opt => {
                            topicSel.innerHTML += `<option value="${opt}">${opt}</option>`;
                        });
                    }
                });
                topicSel.addEventListener('change', function() {
                    subtopicSel.innerHTML = '<option value="">ì†Œë¶„ë¥˜ ì„ íƒ</option>';
                    if (addRuleCategory3Options[topicSel.value]) {
                        addRuleCategory3Options[topicSel.value].forEach(opt => {
                            subtopicSel.innerHTML += `<option value="${opt}">${opt}</option>`;
                        });
                    }
                });
            }
        });
        // ëœë¤ì¶œì œ ì²´í¬ë°•ìŠ¤ ìƒíƒœì— ë”°ë¼ ë¬¸ì œ ì¶œì œ ê·œì¹™, ì‹œí—˜êµ¬ì„± ì˜ì—­ í† ê¸€
        document.addEventListener('DOMContentLoaded', function() {
            const randomOrderCheckbox = document.getElementById('randomOrder');
            const ruleSection = document.getElementById('ruleSection');
            const manualArea = document.getElementById('manualQuestionArea');
            function toggleSections() {
                if (randomOrderCheckbox.checked) {
                    manualArea.style.display = 'none';
                    ruleSection.style.display = '';
                } else {
                    ruleSection.style.display = 'none';
                    manualArea.style.display = '';
                }
            }
            randomOrderCheckbox.addEventListener('change', toggleSections);
            toggleSections();
        });
        // ê·œì¹™ ì˜ˆì‹œ ë°ì´í„° ì œê±°, ë¹ˆ ë°°ì—´ë¡œ ì‹œì‘
        const rules = [];

        // ìˆ˜ë™ ë¬¸ì œ ë¦¬ìŠ¤íŠ¸
        const manualQuestions = [];

        function renderManualQuestions() {
            const list = document.getElementById('manualQuestionList');
            if (!list) return;
            list.innerHTML = '';
            if (manualQuestions.length === 0) {
                list.innerHTML = '<div style="color:#888;font-size:14px;">ì¶”ê°€ëœ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
            } else {
                manualQuestions.forEach((q, idx) => {
                    list.innerHTML += `<div style="background:#f8f9fa;border-radius:6px;padding:10px 16px;margin-bottom:8px;display:flex;align-items:center;justify-content:space-between;">
                        <span style="font-size:15px;">${q}</span>
                        <button type="button" style="font-size:13px;padding:2px 10px;" onclick="removeManualQuestion(${idx})">ì‚­ì œ</button>
                    </div>`;
                });
            }
        }

        // ìˆ˜ë™ ë¬¸ì œ ì‚­ì œ í•¨ìˆ˜ (windowì— ë“±ë¡)
        window.removeManualQuestion = function(idx) {
            manualQuestions.splice(idx, 1);
            renderManualQuestions();
        }

        // ìˆ˜ë™ ë¬¸ì œ ì¶”ê°€ ë²„íŠ¼ ì´ë²¤íŠ¸ + ëª¨ë‹¬
        document.addEventListener('DOMContentLoaded', function() {
            renderManualQuestions();
            const addManualBtn = document.getElementById('addManualQuestionBtn');
            const modal = document.getElementById('questionModal');
            const closeModal = document.getElementById('closeQuestionModal');
            if (addManualBtn) {
                addManualBtn.addEventListener('click', function() {
                    modal.style.display = 'flex';
                });
            }
            if (closeModal) {
                closeModal.addEventListener('click', function() {
                    modal.style.display = 'none';
                });
            }
            window.addEventListener('click', function(e) {
                if (e.target === modal) modal.style.display = 'none';
            });
        });

        // ëª¨ë‹¬ ë‚´ ì¹´í…Œê³ ë¦¬ ì—°ë™ ì˜ˆì‹œ (ì‹¤ì œ DB ì—°ë™ ì‹œ ajax ë“±ìœ¼ë¡œ ëŒ€ì²´)
        const category2Options = {
            'Python': ['ê¸°ì´ˆ', 'ë¬¸ë²•', 'í•¨ìˆ˜', 'ë°˜ë³µë¬¸'],
            'JavaScript': ['ê¸°ì´ˆ', 'ES6', 'DOM', 'ì´ë²¤íŠ¸'],
            'Java': ['ê¸°ì´ˆ', 'OOP', 'ì»¬ë ‰ì…˜', 'ìŠ¤ë ˆë“œ']
        };
        const category3Options = {
            'ê¸°ì´ˆ': ['ë³€ìˆ˜', 'ìë£Œí˜•'],
            'ë¬¸ë²•': ['if', 'for', 'while'],
            'í•¨ìˆ˜': ['ì •ì˜', 'í˜¸ì¶œ'],
            'ë°˜ë³µë¬¸': ['for', 'while'],
            'ES6': ['let', 'arrow'],
            'DOM': ['ì„ íƒì', 'ì¡°ì‘'],
            'ì´ë²¤íŠ¸': ['í´ë¦­', 'ì…ë ¥'],
            'OOP': ['ìƒì†', 'ë‹¤í˜•ì„±'],
            'ì»¬ë ‰ì…˜': ['List', 'Map'],
            'ìŠ¤ë ˆë“œ': ['ìƒì„±', 'ë™ê¸°í™”']
        };
        document.addEventListener('DOMContentLoaded', function() {
            const cat1 = document.getElementById('category1');
            const cat2 = document.getElementById('category2');
            const cat3 = document.getElementById('category3');
            if (cat1 && cat2 && cat3) {
                cat1.addEventListener('change', function() {
                    cat2.innerHTML = '<option value="">ì¤‘ë¶„ë¥˜ ì„ íƒ</option>';
                    cat3.innerHTML = '<option value="">ì†Œë¶„ë¥˜ ì„ íƒ</option>';
                    if (category2Options[cat1.value]) {
                        category2Options[cat1.value].forEach(opt => {
                            cat2.innerHTML += `<option value="${opt}">${opt}</option>`;
                        });
                    }
                });
                cat2.addEventListener('change', function() {
                    cat3.innerHTML = '<option value="">ì†Œë¶„ë¥˜ ì„ íƒ</option>';
                    if (category3Options[cat2.value]) {
                        category3Options[cat2.value].forEach(opt => {
                            cat3.innerHTML += `<option value="${opt}">${opt}</option>`;
                        });
                    }
                });
            }
        });

        // ëª¨ë‹¬ ë‚´ ë¬¸ì œ ê²€ìƒ‰ ë° í˜ì´ì§• ì˜ˆì‹œ (ì‹¤ì œ DB ì—°ë™ ì‹œ ajax ë“±ìœ¼ë¡œ ëŒ€ì²´)
        let questionDB = [
            {title:'íŒŒì´ì¬ forë¬¸', author:'í™ê¸¸ë™', content:'ë°˜ë³µë¬¸ ë¬¸ì œ', category1:'Python', category2:'ë°˜ë³µë¬¸', category3:'for'},
            {title:'ìë°”ìŠ¤í¬ë¦½íŠ¸ ì´ë²¤íŠ¸', author:'ê¹€ì² ìˆ˜', content:'í´ë¦­ ì´ë²¤íŠ¸ ë¬¸ì œ', category1:'JavaScript', category2:'ì´ë²¤íŠ¸', category3:'í´ë¦­'},
            {title:'ìë°” ìƒì†', author:'ì´ì˜í¬', content:'OOP ë¬¸ì œ', category1:'Java', category2:'OOP', category3:'ìƒì†'},
            // ... ë”ë¯¸ ë°ì´í„° ì¶”ê°€ ê°€ëŠ¥
        ];
        function filterQuestions(page=1, perPage=5) {
            const cat1 = document.getElementById('category1').value;
            const cat2 = document.getElementById('category2').value;
            const cat3 = document.getElementById('category3').value;
            const title = document.getElementById('searchTitle').value.trim();
            const author = document.getElementById('searchAuthor').value.trim();
            const content = document.getElementById('searchContent').value.trim();
            let filtered = questionDB.filter(q => {
                if (!cat1 || q.category1 !== cat1) return false;
                if (cat2 && q.category2 !== cat2) return false;
                if (cat3 && q.category3 !== cat3) return false;
                if (title && !q.title.includes(title)) return false;
                if (author && !q.author.includes(author)) return false;
                if (content && !q.content.includes(content)) return false;
                return true;
            });
            // í˜ì´ì§•
            const total = filtered.length;
            const start = (page-1)*perPage;
            const end = start+perPage;
            const pageData = filtered.slice(start, end);
            // ë Œë”ë§
            const list = document.getElementById('questionList');
            list.innerHTML = '';
            if (pageData.length === 0) {
                list.innerHTML = '<div style="color:#888;font-size:14px;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
            } else {
                pageData.forEach((q, idx) => {
                    list.innerHTML += `<div style="background:#f8f9fa;border-radius:6px;padding:10px 16px;margin-bottom:8px;display:flex;align-items:center;justify-content:space-between;">
                        <span style="font-size:15px;">[${q.category1} > ${q.category2} > ${q.category3}] ${q.title} / ${q.author}</span>
                        <button type="button" style="font-size:13px;padding:2px 10px;" onclick="addQuestionToManual('${q.title}')">ì¶”ê°€</button>
                    </div>`;
                });
            }
            // í˜ì´ì§€ë„¤ì´ì…˜
            const pag = document.getElementById('questionPagination');
            pag.innerHTML = '';
            const totalPages = Math.ceil(total/perPage);
            for (let i=1; i<=totalPages; i++) {
                pag.innerHTML += `<button type="button" class="btn" style="padding:2px 8px;${i===page?'background:#e0e0e0;':''}" onclick="filterQuestions(${i},${perPage})">${i}</button>`;
            }
        }
        window.addQuestionToManual = function(title) {
            manualQuestions.push(title);
            renderManualQuestions();
            document.getElementById('questionModal').style.display = 'none';
        }
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('questionSearchForm');
            if (form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    filterQuestions(1,5);
                });
            }
        });

        function renderRules() {
            const ruleList = document.getElementById('ruleList');
            ruleList.innerHTML = '';
            rules.forEach((rule, idx) => {
                let diffStr = Object.entries(rule.difficulty).map(([k,v]) => `${k} ${v}`).join(' / ');
                ruleList.innerHTML += `
                <div class="rule-card" style="background:#f8f9fa;border-radius:8px;padding:18px 20px 14px 20px;margin-bottom:12px;box-shadow:0 1px 4px rgba(0,0,0,0.03);position:relative;">
                    <div class="rule-info" style="font-size:15px;color:#333;line-height:1.7;">
                        <div><strong>ëŒ€ë¶„ë¥˜ > ì¤‘ë¶„ë¥˜ > ì†Œë¶„ë¥˜</strong></div>
                        <div>${rule.subject} > ${rule.topic ? rule.topic : "-"} > ${rule.subtopic ? rule.subtopic : "-"}</div>
                        <div style="margin-top:8px;"><strong>ë‚œì´ë„</strong></div>
                        <div>${diffStr}</div>
                        <div style="margin-top:8px;"><strong>íƒœê·¸</strong></div>
                        ${rule.tags ? `<div>${rule.tags}</div>` : ''}
                        <div style="margin-top:8px;">ì´ ${rule.count}ë¬¸í•­</div>
                    </div>
                    <div class="rule-actions" style="position:absolute;right:18px;top:18px;display:flex;gap:8px;">
                        <button type="button" onclick="deleteRule(${idx})" class="btn btn-gray">ì‚­ì œ</button>
                        <button type="button" onclick="editRule(${idx})" class="btn btn-secondary">ìˆ˜ì •</button>
                    </div>
                </div>
                `;
            });
        }

        function renderManualQuestions() {
            const list = document.getElementById('manualQuestionList');
            if (!list) return;
            list.innerHTML = '';
            if (manualQuestions.length === 0) {
                list.innerHTML = '<div style="color:#888;font-size:14px;">ì¶”ê°€ëœ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
            } else {
                manualQuestions.forEach((q, idx) => {
                    list.innerHTML += `<div style="background:#f8f9fa;border-radius:6px;padding:10px 16px;margin-bottom:8px;display:flex;align-items:center;justify-content:space-between;">
                        <span style="font-size:15px;">${q}</span>
                        <button type="button" class="btn btn-gray" onclick="removeManualQuestion(${idx})">ì‚­ì œ</button>
                    </div>`;
                });
            }
        }

        // ìˆ˜ë™ ë¬¸ì œ ì‚­ì œ í•¨ìˆ˜ (windowì— ë“±ë¡)
        window.removeManualQuestion = function(idx) {
            manualQuestions.splice(idx, 1);
            renderManualQuestions();
        }

        function editRule(idx) {
            alert('ê·œì¹™ ìˆ˜ì • ê¸°ëŠ¥ì€ ì¶”í›„ êµ¬í˜„ ì˜ˆì •ì…ë‹ˆë‹¤.');
        }
        function deleteRule(idx) {
            if (confirm('ì´ ê·œì¹™ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                rules.splice(idx, 1);
                renderRules();
            }
        }
        // ê·œì¹™ ì¶”ê°€ ëª¨ë‹¬ ë™ì‘ robustí•˜ê²Œ ë“±ë¡
        document.addEventListener('DOMContentLoaded', function() {
            const addRuleBtn = document.getElementById('addRuleBtn');
            const addRuleModal = document.getElementById('addRuleModal');
            const closeAddRuleModal = document.getElementById('closeAddRuleModal');
            const cancelAddRule = document.getElementById('cancelAddRule');
            if (addRuleBtn && addRuleModal) {
                addRuleBtn.addEventListener('click', function() {
                    addRuleModal.style.display = 'flex';
                });
            }
            if (closeAddRuleModal) {
                closeAddRuleModal.addEventListener('click', function() {
                    addRuleModal.style.display = 'none';
                });
            }
            if (cancelAddRule) {
                cancelAddRule.addEventListener('click', function() {
                    addRuleModal.style.display = 'none';
                });
            }
            window.addEventListener('click', function(e) {
                if (e.target === addRuleModal) addRuleModal.style.display = 'none';
            });
        });
        document.getElementById('addRuleForm').addEventListener('submit', function(e) {
            e.preventDefault();
            // ë‚œì´ë„ select íŒŒì‹±
            let difficulty = {};
            const level1 = document.getElementById('addRuleDifficultyLevel1').value;
            const count1 = parseInt(document.getElementById('addRuleDifficultyCount1').value);
            const level2 = document.getElementById('addRuleDifficultyLevel2').value;
            const count2 = parseInt(document.getElementById('addRuleDifficultyCount2').value);
            if (level1 && count1) difficulty[level1] = count1;
            if (level2 && count2) difficulty[level2] = count2;
            // ê·œì¹™ ê°ì²´ ìƒì„±
            const newRule = {
                subject: document.getElementById('addRuleSubject').value,
                topic: document.getElementById('addRuleTopic').value,
                subtopic: document.getElementById('addRuleSubtopic').value,
                difficulty,
                tags: document.getElementById('addRuleTags').value.trim(),
                count: parseInt(document.getElementById('addRuleCount').value)
            };
            rules.push(newRule);
            renderRules();
            document.getElementById('addRuleModal').style.display = 'none';
            document.getElementById('addRuleForm').reset();
        });
        renderRules();

        // ê¸°íƒ€ ë²„íŠ¼ ì´ë²¤íŠ¸ ì˜ˆì‹œ
        document.getElementById('previewBtn').addEventListener('click', function() {
            alert('ëœë¤ ìƒ˜í”Œ ìƒì„± ê¸°ëŠ¥ì€ ì¶”í›„ êµ¬í˜„ ì˜ˆì •ì…ë‹ˆë‹¤.');
        });
        document.getElementById('testForm').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('ì‹œí—˜ ì €ì¥ ê¸°ëŠ¥ì€ ì¶”í›„ êµ¬í˜„ ì˜ˆì •ì…ë‹ˆë‹¤.');
        });
        document.querySelector('.btn-assign').addEventListener('click', function() {
            alert('ê³¼ì •ì— ë°°ì •í•˜ê¸° ê¸°ëŠ¥ì€ ì¶”í›„ êµ¬í˜„ ì˜ˆì •ì…ë‹ˆë‹¤.');
        });
    </script>
</body>
</html>