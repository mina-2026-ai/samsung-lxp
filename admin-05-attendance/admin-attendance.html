<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../common-style.css">
    <link rel="stylesheet" href="../sidebar-style.css">
    <link rel="stylesheet" href="../btn-style.css">
    <script src="../sidebar-function.js" defer></script>
    <script src="../common-funtion.js" defer></script>
    <title>Samsung Academy LXP - ê´€ë¦¬ì</title>
    <style>
                /* í…Œì´ë¸” row hover/active ìŠ¤íƒ€ì¼ */
                .history-table tbody tr {
                    transition: background 0.2s;
                    cursor: pointer;
                }
                .history-table tbody tr.row-hover {
                    background: #f0f6ff;
                }
        /* ì¶”ê°€ì ì¸ í˜ì´ì§€ë³„ ìŠ¤íƒ€ì¼ì€ ì—¬ê¸°ì— ì‘ì„± */

        /* ë¹ ë¥¸ ì„ íƒ ê³¼ëª© ì¹´ë“œ ìŠ¤íƒ€ì¼ (course-card ì°¸ê³ ) */
        .quick-select-section {
            margin-bottom: 24px;
        }
        .quick-select-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 12px;
            color: #333;
        }
        .quick-course-list {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-bottom: 16px;
        }
        .quick-course-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 24px 32px;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
            min-width: 180px;
            box-sizing: border-box;
            font-size: 16px;
            color: #333;
        }
        .quick-course-card:hover {
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
            transform: translateY(-4px);
            border-color: #4a8fe7;
        }
        .quick-divider {
            width: 100%;
            height: 2px;
            background: #e0e0e0;
            margin: 0 0 24px 0;
            border-radius: 2px;
        }

        .filter-section {
            margin-top: 24px;
            display: flex;
            justify-content: space-between;
        }

        /* course-card ë‚´ë¶€ êµ¬ì¡° ìŠ¤íƒ€ì¼ */
        .course-top-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        .course-category {
            font-size: 14px;
            font-weight: 700;
            color: #fff;
            background: #007bff;
            padding: 4px 8px;
            border-radius: 12px;
        }
        .toggle-status {
            font-size: 14px;
        }
        .status-toggle {
            padding: 4px 8px;
            border: 1px solid #007bff;
            border-radius: 12px;
            background: #fff;
            color: #007bff;
            cursor: pointer;
        }
        .course-header {
            margin-bottom: 12px;
            text-align: start;
        }
        .course-title {
            font-size: 16px;
            font-weight: 700;
            color: #333;
            margin: 0;
        }
        .instructor-name {
            font-size: 14px;
            color: #777;
        }
        .course-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            background-color: var(--color-line-gray);
            padding: 8px 12px;
            border-radius: 8px;
        }
        .stat-box {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .stat-text {
            font-size: 14px;
            color: #333;
        }
        .divider-vertical {
            width: 1px;
            height: 16px;
            background: #e0e0e0;
            margin: 0 8px;
        }
        .course-progress-info {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 8px;
        }
        .progress-left {
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: flex-start;
        }
        .progress-period {
            font-size: 12px;
            color: #777;
        }
        .progress-percentage {
            font-size: 14px;
            color: var(--color-primary);
        }
        .progress-bar-container {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }
        .progress-bar {
            height: 100%;
            background: #007bff;
            border-radius: 4px;
        }

        /* ì¶œê²°ì •ë³´ í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .attendance-info-section {
            margin-top: 15px;
            display: flex;
            align-items: flex-start;
        }
        .history-table {
            width: 100%;
            border-collapse: collapse;
        }
        .history-table th, .history-table td {
            border: 1px solid #e0e0e0;
            padding: 12px 16px;
            text-align: center;
        }
        .history-table th {
            background: #f7f7f9;
            font-weight: 700;
            color: #333;
        }
        .history-table td {
            font-size: 14px;
            color: #333;
        }

        #name-table td,
        #session-table td,
        #status-table td {
            height: 48px;
            min-height: 48px;
            max-height: 48px;
            box-sizing: border-box;
            padding-top: 0;
            padding-bottom: 0;
            vertical-align: middle;
        }

        .filter-left {
            display: flex;
            gap: 32px;
            align-items: flex-end;
        }

        .course-select-section {
            min-width: 220px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .course-select-section label {
            font-size: 18px;
            color: #333;
        }

        #courseSelect {
            min-width: 300px;
        }

        #name-table {
            width: 180px;
            min-width: 180px;
            max-width: 180px;
        }
        #status-table {
            width: 320px;
            min-width: 320px;
            max-width: 320px;
        }
        .session-table-wrapper {
            flex: 1 1 0;
            min-width: 0;
            overflow-x: auto;
            overflow-y: hidden;
        }
        #session-table {
            width: 100%;
            table-layout: fixed;
        }
        #session-table tr {
            height: 48px;
            min-height: 48px;
            max-height: 48px;
        }
    </style>
</head>
<body>
    <!-- ìƒë‹¨ í—¤ë” -->
    <header class="header">
        <h1>ì¶œê²°/ì´ìˆ˜ ê´€ë¦¬ > ì¶œê²°í˜„í™©</h1>
        <!-- icon -->
        <div class="icon-container">
            <div class="icon-box"><img src="/icons/bell.svg" alt="alert icon" style="width: 28px;"></div>
            <div class="icon-box" onclick="location.href='../admin-00-topmenu/admin-topmenu-user.html'"><img src="/icons/user.svg" alt="user icon" style="width: 30px;"></div>
            <div class="icon-box"><img src="/icons/setting.svg" alt="setting icon" style="width: 25px;"></div>
        </div>
    </header>

    <!-- ì™¼ìª½ ì‚¬ì´ë“œë°” -->
    <aside class="sidebar">
        <!-- ì‚¬ì´ë“œë°” ë©”ë‰´ ë‚´ìš© -->

        <!-- logo-box -->
        <div class="logo-box">
            <img id="sidebarLogo" src="/logo-white.png" alt="logo" style="width: 130px;">
        </div>

        <!-- menu -->
        <nav class="menu">
            <ul>
                <li data-page="../admin-01-dashboard/admin-dashboard.html" onclick="handleMenuClick(this, '../admin-01-dashboard/admin-dashboard.html')">
                    <img src="../icons/01-dashboard.svg" alt="dashboard icon" style="width: 26px; margin-left:-2px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">í˜„í™©(ëŒ€ì‹œë³´ë“œ)</span>
                </li>
                <li data-page="../admin-02-user/admin-user-trainee.html" onclick="handleMenuClick(this, '../admin-02-user/admin-user-trainee.html')" >
                    <img src="../icons/02-user.svg" alt="user icon" style="width: 28px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ì‚¬ìš©ì ê´€ë¦¬</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-02-user/admin-user-trainee.html'">í›ˆë ¨ìƒ ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-02-user/admin-user-instructor.html'">ê°•ì‚¬ ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-02-user/admin-user.html'">ê´€ë¦¬ì ê´€ë¦¬</li>
                    </ul>
                </li>
                <li data-page="../admin-03-courses/admin-course-edu.html" onclick="handleMenuClick(this, '../admin-03-courses/admin-courses-edu.html')">
                    <img src="../icons/03-course.svg" alt="course icon" style="width: 25px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ê³¼ì •/ìš´ì˜ ê´€ë¦¬</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-03-courses/admin-courses-edu.html'">ê³¼ì • ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-03-courses/admin-courses-schedule.html'">ì¼ì • ê´€ë¦¬</li>
                    </ul>
                </li>
                <li data-page="../admin-04-evaluation/admin-evaluation-assignment.html" onclick="handleMenuClick(this, '../admin-04-evaluation/admin-evaluation-assignment.html')">
                    <img src="../icons/04-evaluation.svg" alt="evaluation icon" style="width: 30px; margin-left:-4px; margin-right: 7px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">í‰ê°€ ê´€ë¦¬</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-04-evaluation/admin-evaluation-question-bank.html'">ë¬¸ì œ ì€í–‰</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-04-evaluation/admin-evaluation-assignment.html'">ê³¼ì œ ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-04-evaluation/admin-evaluation-test.html'">ì‹œí—˜ ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-04-evaluation/admin-evaluation-result.html'">ì±„ì  ë° ê²°ê³¼ ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-04-evaluation/admin-evaluation-monitoring.html'">í‰ê°€ ëª¨ë‹ˆí„°ë§</li>
                    </ul>
                </li>
                <li data-page="../admin-05-attendance/admin-attendance.html" onclick="handleMenuClick(this, '../admin-05-attendance/admin-attendance.html')">
                    <img src="../icons/05-attendance.svg" alt="attendance icon" style="width: 28px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text active_menu">ì¶œê²°/ì´ìˆ˜ ê´€ë¦¬</span>
                    <ul>
                        <li class="submenu active_menu" onclick="event.stopPropagation(); location.href='../admin-05-attendance/admin-attendance.html'">ì¶œê²°í˜„í™©</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-05-attendance/admin-attendance-graduate.html'">ì´ìˆ˜ ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-05-attendance/admin-attendance-survey.html'">ì„¤ë¬¸ì¡°ì‚¬ ê´€ë¦¬</li>
                    </ul>
                </li>
                <li data-page="../admin-06-support/admin-support-tutoring.html" onclick="handleMenuClick(this, '../admin-06-support/admin-support-tutoring.html')">
                    <img src="../icons/06-support.svg" alt="support icon" style="width: 25px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">í•™ìŠµ ì§€ì›</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-06-support/admin-support-tutoring.html'">íŠœí„°ë§/QnA</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-06-support/admin-support-response.html'">ì‘ë‹µí˜„í™©</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-06-support/admin-support-chat-monitoring.html'">ì±„íŒ… ëª¨ë‹ˆí„°ë§</li>
                    </ul>
                </li>
                <li data-page="../admin-07-notice/admin-notice.html" onclick="handleMenuClick(this, '../admin-07-notice/admin-notice.html')" class="white-icon">
                    <img src="../icons/bell.svg" alt="notice icon" style="width: 26px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ê³µì§€/ì•Œë¦¼</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-07-notice/admin-notice.html'">ê³µì§€ ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-07-notice/admin-notice-alarm.html'">ì•Œë¦¼ ê´€ë¦¬</li>
                    </ul>
                </li>
            </ul>
        </nav>
                <span class="logout" onclick="location.href='../01-login/login.html'">ë¡œê·¸ì•„ì›ƒ 

            <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px" fill="CurrentColor">
                <path d="M186.67-120q-27 0-46.84-19.83Q120-159.67 120-186.67v-586.66q0-27 19.83-46.84Q159.67-840 186.67-840h292.66v66.67H186.67v586.66h292.66V-120H186.67Zm470.66-176.67-47-48 102-102H360v-66.66h351l-102-102 47-48 184 184-182.67 182.66Z"/>
            </svg>
        </span>
    </aside>

    <!-- í† ê¸€ ë²„íŠ¼ -->
    <div class="toggle-btn" onclick="toggleSidebar()">
        â—€
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <main class="main-content">
        <!-- í›ˆë ¨ìƒ ê´€ë¦¬ -->
        <section class="main-content-inner">
            <div class="section-header">
                <h2>ë¹ ë¥¸ì„ íƒ</h2>
            </div>

            <!-- ë¹ ë¥¸ ì„ íƒ ê³¼ëª© ì¹´ë“œ ì˜ì—­ -->
                <div class="quick-course-list" id="quickCourseList">
                    <!-- JSì—ì„œ ë™ì ìœ¼ë¡œ ìƒì„± -->
                </div>
                <div class="divider"></div>
            <!-- </div> -->

            <section class="filter-section">
                <div class="filter-left">
                    <!-- ê³¼ì • ì„ íƒ ì˜ì—­ -->
                    <div class="course-select-section">
                        <label for="courseSelect">ê³¼ì • ì„ íƒ</label>
                        <select id="courseSelect">
                            <option value="course1">í’€ìŠ¤íƒ ì›¹ ê°œë°œ (React & Node.js)</option>
                            <option value="course2">AI ì—”ì§€ë‹ˆì–´ë§</option>
                        </select>
                    </div>
    
                    <!-- ì°¨ì‹œ ì„ íƒ ì˜ì—­ -->
                    <div class="course-select-section">
                        <label for="sessionSelect">ì°¨ì‹œ ì„ íƒ</label>
                        <select id="sessionSelect">
                            <!-- ì˜µì…˜ì€ JSì—ì„œ ë™ì ìœ¼ë¡œ ìƒì„± -->
                        </select>
                    </div>
                </div>

                <!-- ì •ë ¬ ê¸°ì¤€ ì˜ì—­ -->
                <div class="course-select-section">
                    <label for="sortSelect">ì •ë ¬ ê¸°ì¤€</label>
                    <select id="sortSelect" style="min-width: 120px;">
                        <option value="name">ì´ë¦„ìˆœ</option>
                        <option value="rate">ìˆ˜ê°•ë¥ </option>
                        <option value="risk">ì´íƒˆìœ„í—˜ë„</option>
                    </select>
                    <button id="sortOrderBtn" type="button" style="height: 36px; width: 36px; border: 1px solid #ccc; background: #fff; border-radius: 6px; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                        <span id="sortOrderIcon" style="font-size: 18px;">â–²</span>
                    </button>
                </div>                
            </section>


            <!-- ì¶œê²°ì •ë³´ í…Œì´ë¸” -->
            <div class="attendance-info-section">

                <table id="name-table" class="history-table">
                    <thead>
                        <tr>
                            <th>ë²ˆí˜¸</th>
                            <th>í›ˆë ¨ìƒëª…</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ë™ì  ìƒì„± -->
                    </tbody>
                </table>
                <div class="session-table-wrapper">
                    <table id="session-table" class="history-table">
                        <thead>
                            <!-- ë™ì  ìƒì„± -->
                        </thead>
                        <tbody>
                            <!-- ë™ì  ìƒì„± -->
                        </tbody>
                    </table>
                </div>
                <table id="status-table" class="history-table">
                    <thead>
                        <tr>
                            <th>ì´ìˆ˜í˜„í™©</th>
                            <th>ìˆ˜ê°•ë¥ </th>
                            <th>ì´íƒˆìœ„í—˜ë„</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ë™ì  ìƒì„± -->
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <script>
        // ë¹ ë¥¸ ì„ íƒ ê³¼ëª© ì¹´ë“œ ë°ì´í„° ì˜ˆì‹œ (DBì—ì„œ ë°›ì•„ì˜¨ë‹¤ê³  ê°€ì •)
        const courseCardData = [
            {
                courseId: 'course1',
                category: 'KDT',
                status: 'í™œì„±ì¤‘',
                title: 'í’€ìŠ¤íƒ ì›¹ ê°œë°œ (React & Node.js)',
                instructor: 'ê¹€ë¯¼ìˆ˜ ê°•ì‚¬',
                subjectCount: 12,
                totalHours: 120,
                studentCount: 45,
                running: true,
                period: '2026.01.02 ~ 2026.06.30',
                progress: 42
            },
            {
                courseId: 'course2',
                category: 'AI',
                status: 'ë¹„í™œì„±',
                title: 'AI ì—”ì§€ë‹ˆì–´ë§',
                instructor: 'ì´ìˆ˜ì§„ ê°•ì‚¬',
                subjectCount: 10,
                totalHours: 100,
                studentCount: 30,
                running: false,
                period: '2026.02.01 ~ 2026.07.15',
                progress: 65
            }
        ];

        function renderCourseCards() {
            const list = document.getElementById('quickCourseList');
            list.innerHTML = '';
            courseCardData.forEach(card => {
                const div = document.createElement('div');
                div.className = 'quick-course-card';
                div.innerHTML = `
                    <div class="course-top-section">
                        <span class="course-category badge-kdt">${card.category}</span>
                        <div class="toggle-status">
                            <span>${card.status}</span>
                        </div>
                    </div>
                    <div class="course-header">
                        <h3 class="course-title">${card.title}</h3>
                        <span class="instructor-name">${card.instructor}</span>
                    </div>
                    <div class="course-stats">
                        <div class="stat-box"><span class="stat-text">ê³¼ëª© <strong>${card.subjectCount}</strong>ê°œ</span></div>
                        <div class="divider-vertical"></div>
                        <div class="stat-box"><span class="stat-text">ì´ <strong>${card.totalHours}</strong>ì‹œê°„</span></div>
                        <div class="divider-vertical"></div>
                        <div class="stat-box"><span class="stat-text">ìˆ˜ê°•ìƒ <strong>${card.studentCount}</strong>ëª…</span></div>
                    </div>
                    <div class="course-progress-info">
                        <div class="progress-left">
                            <span class="status-badge ${card.running ? 'status-completed' : 'status-disabled'}">${card.running ? 'ìš´ì˜ì¤‘' : 'ì¢…ë£Œ'}</span>
                            <span class="progress-period">ğŸ“… ${card.period}</span>
                        </div>
                        <span class="progress-percentage">${card.progress}%</span>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" style="width: ${card.progress}%;"></div>
                    </div>
                `;
                // ì¹´ë“œ í´ë¦­ ì‹œ ê³¼ì • ì„ íƒ select ë³€ê²½
                div.addEventListener('click', () => {
                    const courseSelect = document.getElementById('courseSelect');
                    if (courseSelect) {
                        courseSelect.value = card.courseId;
                        // íŠ¸ë¦¬ê±°: ê³¼ì • ë³€ê²½ ì‹œ í•„ìš”í•œ í•¨ìˆ˜ í˜¸ì¶œ
                        updateSessionSelect();
                        renderNameTable();
                        renderSessionTable();
                        renderStatusTable();
                    }
                });
                list.appendChild(div);
            });
        }
        // ì •ë ¬ ìƒíƒœ ë³€ìˆ˜
        let sortKey = 'name';
        let sortAsc = true;

        // ì •ë ¬ ê¸°ì¤€/ìˆœì„œ UI ì´ë²¤íŠ¸
        document.addEventListener('DOMContentLoaded', () => {
            const sortSelect = document.getElementById('sortSelect');
            const sortOrderBtn = document.getElementById('sortOrderBtn');
            const sortOrderIcon = document.getElementById('sortOrderIcon');
            if (sortSelect && sortOrderBtn && sortOrderIcon) {
                sortSelect.addEventListener('change', () => {
                    sortKey = sortSelect.value;
                    renderNameTable();
                    renderSessionTable();
                    renderStatusTable();
                });
                sortOrderBtn.addEventListener('click', () => {
                    sortAsc = !sortAsc;
                    sortOrderIcon.textContent = sortAsc ? 'â–²' : 'â–¼';
                    renderNameTable();
                    renderSessionTable();
                    renderStatusTable();
                });
            }
        });
        // ê³¼ì •ë³„ ì¶œê²°ì •ë³´ ì˜ˆì‹œ ë°ì´í„° (DBì—ì„œ 15ê°œ ì°¨ì‹œ)
        const courseAttendanceData = {
            course1: [
                {
                    no: 1,
                    name: 'í™ê¸¸ë™',
                    sessions: [true,true,true,true,true,true,true,true,true,false,true,true,true,true,true,true],
                    rate: '93%',
                    risk: 'low'
                },
                {
                    no: 2,
                    name: 'ê¹€ë¯¼ì•„',
                    sessions: [true,true,false,true,false,true,true,true,true,true,true,false,true,true,false,true],
                    rate: '80%',
                    risk: 'high'
                }
            ],
            course2: [
                {
                    no: 1,
                    name: 'ì´ìˆ˜ì§„',
                    sessions: [true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],
                    rate: '100%',
                    risk: 'low'
                },
                {
                    no: 2,
                    name: 'ë°•ì² ìˆ˜',
                    sessions: [true,false,true,true,true,true,true,true,true,true,true,true,true,true,true],
                    rate: '93%',
                    risk: 'medium'
                }
            ]
        };

        function updateSessionSelect() {
            const courseId = document.getElementById('courseSelect').value;
            const attendanceData = courseAttendanceData[courseId] || [];
            const sessionCount = attendanceData.length > 0 ? attendanceData[0].sessions.length : 0;
            const sessionSelect = document.getElementById('sessionSelect');
            sessionSelect.innerHTML = '';
            // ì „ì²´ë³´ê¸° ì˜µì…˜ ì¶”ê°€
            const allOption = document.createElement('option');
            allOption.value = 'all';
            allOption.textContent = 'ì „ì²´ë³´ê¸°';
            sessionSelect.appendChild(allOption);
            for (let i = 1; i <= sessionCount; i += 10) {
                const end = Math.min(i + 9, sessionCount);
                const option = document.createElement('option');
                option.value = `${i}-${end}`;
                option.textContent = `${i}~${end}ì°¨ì‹œ`;
                sessionSelect.appendChild(option);
            }
        }

        function getSortedAttendanceData(courseId) {
            let data = (courseAttendanceData[courseId] || []).slice();
            if (sortKey === 'name') {
                data.sort((a, b) => sortAsc ? a.name.localeCompare(b.name) : b.name.localeCompare(a.name));
            } else if (sortKey === 'rate') {
                data.sort((a, b) => {
                    const aRate = parseInt(a.rate);
                    const bRate = parseInt(b.rate);
                    return sortAsc ? aRate - bRate : bRate - aRate;
                });
            } else if (sortKey === 'risk') {
                // ìœ„í—˜ë„: low < medium < high
                const riskOrder = { low: 0, medium: 1, high: 2 };
                data.sort((a, b) => sortAsc ? riskOrder[a.risk] - riskOrder[b.risk] : riskOrder[b.risk] - riskOrder[a.risk]);
            }
            return data;
        }

        function renderNameTable() {
            const courseId = document.getElementById('courseSelect').value;
            const attendanceData = getSortedAttendanceData(courseId);
            const tbody = document.querySelector('#name-table tbody');
            tbody.innerHTML = '';
            attendanceData.forEach((row, idx) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${row.no}</td><td>${row.name}</td>`;
                tr.addEventListener('mouseenter', () => handleRowHover(idx, true));
                tr.addEventListener('mouseleave', () => handleRowHover(idx, false));
                tr.addEventListener('click', () => {
                    window.location.href = 'admin-attendance-detail.html';
                });
                tbody.appendChild(tr);
            });
        }
        function renderStatusTable() {
            const courseId = document.getElementById('courseSelect').value;
            const attendanceData = getSortedAttendanceData(courseId);
            let tbody = document.querySelector('#status-table tbody');
            if (!tbody) {
                tbody = document.createElement('tbody');
                document.querySelector('#status-table').appendChild(tbody);
            }
            tbody.innerHTML = '';
            attendanceData.forEach((row, idx) => {
                const tr = document.createElement('tr');
                // ì´ìˆ˜í˜„í™©: ì´ìˆ˜í•œ ì°¨ì‹œ ê°œìˆ˜/ì „ì²´ ì°¨ì‹œ ê°œìˆ˜
                const completed = row.sessions.filter(s => s).length;
                const total = row.sessions.length;
                tr.innerHTML = `
                    <td>${completed}/${total}</td>
                    <td>${row.rate}</td>
                    <td><span style="color:${row.risk==='low'?'#28a745':row.risk==='high'?'#dc3545':'#ffc107'};font-weight:600;">â— ${row.risk==='low'?'ë‚®ìŒ':row.risk==='high'?'ë†’ìŒ':'ì¤‘ê°„'}</span></td>
                `;
                tr.addEventListener('mouseenter', () => handleRowHover(idx, true));
                tr.addEventListener('mouseleave', () => handleRowHover(idx, false));
                tr.addEventListener('click', () => {
                    window.location.href = 'admin-attendance-detail.html';
                });
                tbody.appendChild(tr);
            });
        }
        function renderSessionTable() {
            const courseId = document.getElementById('courseSelect').value;
            const attendanceData = getSortedAttendanceData(courseId);
            const sessionValue = document.getElementById('sessionSelect').value;
            let startIdx = 0, endIdx = 0, isAll = false;
            let sessionCount = attendanceData.length > 0 ? attendanceData[0].sessions.length : 0;
            if (sessionValue === 'all') {
                startIdx = 0;
                endIdx = sessionCount - 1;
                isAll = true;
            } else {
                const sessionRange = sessionValue.split('-').map(Number);
                startIdx = sessionRange[0] - 1;
                endIdx = sessionRange[1] - 1;
            }
            // ë™ì  thead ìƒì„± (ì„ íƒëœ êµ¬ê°„ë§Œ)
            const thead = document.querySelector('#session-table thead');
            thead.innerHTML = '';
            const thRow = document.createElement('tr');
            for (let i = startIdx; i <= endIdx; i++) {
                const th = document.createElement('th');
                th.textContent = `ì°¨ì‹œ${i+1}`;
                thRow.appendChild(th);
            }
            thead.appendChild(thRow);
            // ë™ì  tbody ìƒì„± (ì„ íƒëœ êµ¬ê°„ë§Œ)
            let tbody = document.querySelector('#session-table tbody');
            if (!tbody) {
                tbody = document.createElement('tbody');
                document.querySelector('#session-table').appendChild(tbody);
            }
            tbody.innerHTML = '';
            attendanceData.forEach((row, idx) => {
                const tr = document.createElement('tr');
                row.sessions.slice(startIdx, endIdx+1).forEach(s => {
                    const td = document.createElement('td');
                    td.textContent = s ? 'O' : 'X';
                    tr.appendChild(td);
                });
                tr.addEventListener('mouseenter', () => handleRowHover(idx, true));
                tr.addEventListener('mouseleave', () => handleRowHover(idx, false));
                tr.addEventListener('click', () => {
                    window.location.href = 'admin-attendance-detail.html';
                });
                tbody.appendChild(tr);
            });
            // ì „ì²´ë³´ê¸°ì¼ ë•Œë§Œ min-width ë™ì  ì„¤ì •
            const sessionTable = document.getElementById('session-table');
            const wrapper = document.querySelector('.session-table-wrapper');
            if (isAll) {
                const minWidth = (sessionCount) * 100;
                sessionTable.style.minWidth = minWidth + 'px';
                wrapper.style.overflowX = 'auto';
            } else {
                sessionTable.style.minWidth = '';
                wrapper.style.overflowX = '';
            }
        }
        // row hover ë™ê¸°í™” í•¨ìˆ˜
        function handleRowHover(idx, isHover) {
            const nameRows = document.querySelectorAll('#name-table tbody tr');
            const sessionRows = document.querySelectorAll('#session-table tbody tr');
            const statusRows = document.querySelectorAll('#status-table tbody tr');
            [nameRows[idx], sessionRows[idx], statusRows[idx]].forEach(tr => {
                if (tr) {
                    if (isHover) {
                        tr.classList.add('row-hover');
                    } else {
                        tr.classList.remove('row-hover');
                    }
                }
            });
        }
        document.getElementById('courseSelect').addEventListener('change', () => {
            updateSessionSelect();
            renderNameTable();
            renderSessionTable();
            renderStatusTable();
            // renderAttendanceTable();
        });
        document.getElementById('sessionSelect').addEventListener('change', () => {
            renderSessionTable();
            renderStatusTable();
            // renderAttendanceTable();
        });
        document.addEventListener('DOMContentLoaded', () => {
            renderCourseCards();
            updateSessionSelect();
            renderNameTable();
            renderSessionTable();
            renderStatusTable();
        });

        
    </script>
</body>
</html>