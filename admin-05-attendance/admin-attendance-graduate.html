<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="static/css/common-style.css">
    <link rel="stylesheet" href="static/css/sidebar-style.css">
    <link rel="stylesheet" href="static/css/btn-style.css">
    
    <script src="static/js/sidebar-function.js" defer></script>
    <script src="static/js/common-funtion.js" defer></script>
    <title>Samsung Academy LXP - ê´€ë¦¬ì</title>
    <style>
        /* í…Œì´ë¸” row hover/active ìŠ¤íƒ€ì¼ */
        .history-table tbody tr {
            transition: background 0.2s;
            cursor: pointer;
        }
        .history-table tbody tr.row-hover {
            background: #f0f6ff;
        }

        /* ë¹ ë¥¸ ì„ íƒ ê³¼ëª© ì¹´ë“œ ìŠ¤íƒ€ì¼ (course-card ì°¸ê³ ) */
        .quick-select-section {
            margin-bottom: 24px;
        }
        .quick-select-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 12px;
            color: #333;
        }
        .quick-course-list {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-bottom: 16px;
        }
        .quick-course-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 24px 32px;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
            min-width: 180px;
            box-sizing: border-box;
            font-size: 16px;
            color: #333;
        }
        .quick-course-card:hover {
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
            transform: translateY(-4px);
            border-color: #4a8fe7;
        }
        .quick-divider {
            width: 100%;
            height: 2px;
            background: #e0e0e0;
            margin: 0 0 24px 0;
            border-radius: 2px;
        }

        .filter-section {
            margin-top: 24px;
            display: flex;
            justify-content: space-between;
        }

        /* course-card ë‚´ë¶€ êµ¬ì¡° ìŠ¤íƒ€ì¼ */
        .course-top-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        .course-category {
            font-size: 14px;
            font-weight: 700;
            color: #fff;
            background: #007bff;
            padding: 4px 8px;
            border-radius: 12px;
        }
        .toggle-status {
            font-size: 14px;
        }
        .status-toggle {
            padding: 4px 8px;
            border: 1px solid #007bff;
            border-radius: 12px;
            background: #fff;
            color: #007bff;
            cursor: pointer;
        }
        .course-header {
            margin-bottom: 12px;
            text-align: start;
        }
        .course-title {
            font-size: 16px;
            font-weight: 700;
            color: #333;
            margin: 0;
        }
        .instructor-name {
            font-size: 14px;
            color: #777;
        }
        .course-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            background-color: var(--color-line-gray);
            padding: 8px 12px;
            border-radius: 8px;
        }
        .stat-box {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .stat-text {
            font-size: 14px;
            color: #333;
        }
        .divider-vertical {
            width: 1px;
            height: 16px;
            background: #e0e0e0;
            margin: 0 8px;
        }
        .course-progress-info {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 8px;
        }
        .progress-left {
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: flex-start;
        }
        .progress-period {
            font-size: 12px;
            color: #777;
        }
        .progress-percentage {
            font-size: 14px;
            color: var(--color-primary);
        }
        .progress-bar-container {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }
        .progress-bar {
            height: 100%;
            background: #007bff;
            border-radius: 4px;
        }

        /* ì¶œê²°ì •ë³´ í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .attendance-info-section {
            margin-top: 15px;
            display: flex;
            align-items: flex-start;
        }
        .history-table {
            width: 100%;
            border-collapse: collapse;
        }
        .history-table th, .history-table td {
            border: 1px solid #e0e0e0;
            padding: 12px 16px;
            text-align: center;
        }
        .history-table th {
            background: #f7f7f9;
            font-weight: 700;
            color: #333;
        }
        .history-table td {
            font-size: 14px;
            color: #333;
        }

        .final-passed {
            color: #007bff;
            font-weight: 700;
        }
        .final-failed {
            color: #dc3545;
            font-weight: 700;
        }

        .filter-left {
            display: flex;
            gap: 32px;
            align-items: flex-end;
        }

        .course-select-section {
            min-width: 220px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .course-select-section label {
            font-size: 18px;
            color: #333;
        }

        /* ëª¨ë‹¬ */
        .modal-content {
            background-color: white;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }
        /* ì´ˆëŒ€ íŒì—… ëª¨ë‹¬ */
        .status-change-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .status-change-modal.show {
            display: flex;
        }

        .modal-header {
            padding: 25px 30px;
            border-bottom: 1px solid var(--color-line-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            font-size: 20px;
            font-weight: 600;
            color: var(--color-font-gray);
        }

        .modal-body {
            padding: 30px;
        }

        .modal-footer {
            padding: 20px 30px;
            border-top: 1px solid var(--color-line-gray);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }


</style>
</head>
<body>
    <!-- ìƒë‹¨ í—¤ë” -->
    <header class="header">
        <h1>ì¶œê²°/ì´ìˆ˜ ê´€ë¦¬ > ì´ìˆ˜ ê´€ë¦¬</h1>
        <!-- icon -->
        <div class="icon-container">
            <div class="icon-box"><img src="static/icons/bell.svg" alt="alert icon" style="width: 28px;"></div>
            <div class="icon-box" onClick="location.href='../admin-00-topmenu/admin-topmenu-user.html'"><img src="static/icons/user.svg" alt="user icon" style="width: 30px;"></div>
            <div class="icon-box"><img src="static/icons/setting.svg" alt="setting icon" style="width: 25px;"></div>
        </div>
    </header>

    <!-- ì™¼ìª½ ì‚¬ì´ë“œë°” -->
    <aside class="sidebar">
        <!-- ì‚¬ì´ë“œë°” ë©”ë‰´ ë‚´ìš© -->

        <!-- logo-box -->
        <div class="logo-box">
            <img id="sidebarLogo" src="/static/img/logo-white.png" alt="logo" style="width: 130px;">
        </div>

        <!-- menu -->
        <nav class="menu">
            <ul>
                <li data-page="templates/admin/dashboard.html" onclick="handleMenuClick(this, 'templates/admin/dashboard.html')">
                    <img src="static/icons/01-dashboard.svg" alt="dashboard icon" style="width: 26px; margin-left:-2px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">í˜„í™©(ëŒ€ì‹œë³´ë“œ)</span>
                </li>
                <li data-page="../admin-02-user/admin-user-trainee.html" onclick="handleMenuClick(this, '../admin-02-user/admin-user-trainee.html')" >
                    <img src="static/icons/02-user.svg" alt="user icon" style="width: 28px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ì‚¬ìš©ì ê´€ë¦¬</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-02-user/admin-user-trainee.html'">í›ˆë ¨ìƒ ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-02-user/admin-user-instructor.html'">ê°•ì‚¬ ê´€ë¦¬</li>
                         <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-02-user/admin-user.html'">ê´€ë¦¬ì ê´€ë¦¬</li>
                    </ul>
                </li>
                <li data-page="../admin-04-evaluation/admin-evaluation-question-bank.html" onclick="handleMenuClick(this, '../admin-04-evaluation/admin-evaluation-question-bank.html')">
                    <img src="static/icons/03-description.svg" alt="evaluation icon" style="width: 26px; margin-left:0px; margin-right: 7px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ì½˜í…ì¸  ê´€ë¦¬</span>
                </li>
                <li data-page="../admin-03-courses/admin-course-edu.html" onclick="handleMenuClick(this, '../admin-03-courses/admin-courses-edu.html')">
                    <img src="static/icons/03-course.svg" alt="course icon" style="width: 25px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ê³¼ì •/ìš´ì˜ ê´€ë¦¬</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-03-courses/admin-courses-edu.html'">ê³¼ì • ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-03-courses/admin-courses-schedule.html'">ì¼ì • ê´€ë¦¬</li>
                    </ul>
                </li>
                <li data-page="../admin-04-evaluation/admin-evaluation-assignment.html" onclick="handleMenuClick(this, '../admin-04-evaluation/admin-evaluation-assignment.html')">
                    <img src="static/icons/04-evaluation.svg" alt="evaluation icon" style="width: 30px; margin-left:-4px; margin-right: 7px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">í‰ê°€ ê´€ë¦¬</span>
                    <ul>
                                                <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-04-evaluation/admin-evaluation-assignment.html'">ê³¼ì œ ë°°ì • ë° ì±„ì </li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-04-evaluation/admin-evaluation-test.html'">ì‹œí—˜ ê´€ë¦¬</li>

                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-04-evaluation/admin-evaluation-result.html'">ì‹œí—˜ ë°°ì • ë° ì±„ì </li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-04-evaluation/admin-evaluation-monitoring.html'">í‰ê°€ ëª¨ë‹ˆí„°ë§</li>
                    </ul>
                </li>
                <li data-page="../admin-05-attendance/admin-attendance.html" onclick="handleMenuClick(this, '../admin-05-attendance/admin-attendance.html')">
                    <img src="static/icons/05-attendance.svg" alt="attendance icon" style="width: 28px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text active_menu">ì¶œê²°/ì´ìˆ˜ ê´€ë¦¬</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-05-attendance/admin-attendance.html'">ì¶œê²°í˜„í™©</li>
                        <li class="submenu active_menu" onclick="event.stopPropagation(); location.href='../admin-05-attendance/admin-attendance-graduate.html'">ì´ìˆ˜ ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-05-attendance/admin-attendance-survey.html'">ì„¤ë¬¸ì¡°ì‚¬ ê´€ë¦¬</li>
                    </ul>
                </li>
                <li data-page="../admin-06-support/admin-support-tutoring.html" onclick="handleMenuClick(this, '../admin-06-support/admin-support-tutoring.html')">
                    <img src="static/icons/06-support.svg" alt="support icon" style="width: 25px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">í•™ìŠµ ì§€ì›</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-06-support/admin-support-tutoring.html'">íŠœí„°ë§/Q&A</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-06-support/admin-support-response.html'">ì‘ë‹µí˜„í™©</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-06-support/admin-support-chat-monitoring.html'">ì±„íŒ… ëª¨ë‹ˆí„°ë§</li>
                    </ul>
                </li>
                <li data-page="../admin-07-notice/admin-notice.html" onclick="handleMenuClick(this, '../admin-07-notice/admin-notice.html')" class="white-icon">
                    <img src="static/icons/bell.svg" alt="notice icon" style="width: 26px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ê³µì§€/ì•Œë¦¼</span>
                    <ul>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-07-notice/admin-notice.html'">ê³µì§€ ê´€ë¦¬</li>
                        <li class="submenu" onclick="event.stopPropagation(); location.href='../admin-07-notice/admin-alarm.html'">ì•Œë¦¼ ê´€ë¦¬</li>
                    </ul>
                </li>
            </ul>
        </nav>
                <span class="logout" onclick="location.href='../01-login/login.html'">ë¡œê·¸ì•„ì›ƒ 

            <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px" fill="CurrentColor">
                <path d="M186.67-120q-27 0-46.84-19.83Q120-159.67 120-186.67v-586.66q0-27 19.83-46.84Q159.67-840 186.67-840h292.66v66.67H186.67v586.66h292.66V-120H186.67Zm470.66-176.67-47-48 102-102H360v-66.66h351l-102-102 47-48 184 184-182.67 182.66Z"/>
            </svg>
        </span>
    </aside>

    <!-- í† ê¸€ ë²„íŠ¼ -->
    <div class="toggle-btn" onclick="toggleSidebar()">
        â—€
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <main class="main-content">
        <section class="main-content-inner">
            <div class="section-header">
                <h2>ë¹ ë¥¸ì„ íƒ</h2>
            </div>

            <!-- ë¹ ë¥¸ ì„ íƒ ê³¼ëª© ì¹´ë“œ ì˜ì—­ -->
                <div class="quick-course-list" id="quickCourseList">
                    <!-- JSì—ì„œ ë™ì ìœ¼ë¡œ ìƒì„± -->
                </div>
                <div class="divider"></div>
            <!-- </div> -->

            <section class="filter-section">
                <div style="display: flex; gap:16px; align-items: center;">
                    <div class="filter-left">
                        <!-- ê³¼ì • ì„ íƒ ì˜ì—­ -->
                        <div class="course-select-section">
                            <label for="courseSelect">ê³¼ì • ì„ íƒ</label>
                            <select id="courseSelect">
                                <option value="view-all">-- ì „ì²´ë³´ê¸° --</option>
                                <option value="course1">í’€ìŠ¤íƒ ì›¹ ê°œë°œ (React & Node.js)</option>
                                <option value="course2">AI ì—”ì§€ë‹ˆì–´ë§</option>
                            </select>
                        </div>
        
                    </div>

                    <button id="statusChangeBtn" class="btn btn-gray" onclick="openStatusChangeModal()">ë¹ ë¥¸ ìƒíƒœë³€ê²½</button>
                    <button class="btn btn-secondary">ì´ìˆ˜ì¦ ì¶œë ¥</button>
                    <button class="btn-excel" onclick="uploadExcel()">
                            <img src="static/icons/excel.svg" alt="Excel icon">
                            <span>ì—‘ì…€ë¡œ ë‹¤ìš´ë¡œë“œ</span>
                    </button>
                </div>
                <!-- ì •ë ¬ ê¸°ì¤€ ì˜ì—­ -->
                <div class="course-select-section">
                    <label for="sortSelect">ì •ë ¬ ê¸°ì¤€</label>
                    <select id="sortSelect" style="min-width: 120px;">
                        <option value="name">ì´ë¦„ìˆœ</option>
                        <option value="rate">ì¶œê²°ë¥ </option>
                        <option value="confirmedDate">í™•ì •ì¼ì</option>
                        <option value="finalDecision">ìµœì¢…íŒì •</option>
                        <option value="completionStatus">ì´ìˆ˜í™•ì •ìƒíƒœ</option>
                    </select>
                    <button id="sortOrderBtn" type="button" style="height: 36px; width: 36px; border: 1px solid #ccc; background: #fff; border-radius: 6px; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                        <span id="sortOrderIcon" style="font-size: 18px;">â–²</span>
                    </button>
                </div>       
            </section>


            <!-- ì¶œê²°ì •ë³´ í…Œì´ë¸” -->
            <div class="attendance-info-section">

                <table id="graduate_table" class="history-table">
                    <thead>
                        <tr>
                            <th><button id="selectAllBtn" class="btn-small">ì „ì²´ì„ íƒ</button></th>
                            <th>ë²ˆí˜¸</th>
                            <th>í›ˆë ¨ìƒëª…</th>
                            <th>ìƒë…„ì›”ì¼</th>
                            <th>ê³¼ì •ëª…/ê¸°ìˆ˜</th>
                            <th>ì¶œê²°ë¥ (%)</th>
                            <th>ì´ìˆ˜ìƒíƒœ</th>
                            <th>ì´ìˆ˜í™•ì •ìƒíƒœ</th>
                            <th>ìµœì¢…íŒì •</th>
                            <th>í™•ì •ì¼ì</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ë™ì  ìƒì„± -->
                    </tbody>
                </table>
            </div>
        </section>
    </main>
    <!-- í›ˆë ¨ìƒ ì´ˆëŒ€ íŒì—… ëª¨ë‹¬ -->
    <div id="statusChangeModal" class="status-change-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ë¹ ë¥¸ ìƒíƒœë³€ê²½</h2>
                <button class="modal-close" onclick="closeStatusChangeModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="CurrentColor"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <p>ì„ íƒí•œ í›ˆë ¨ìƒë“¤ì˜ ì´ìˆ˜í™•ì •ìƒíƒœë¥¼ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
                <div style="margin-top: 20px;">
                    <label for="newStatusSelect">ìƒˆ ì´ìˆ˜í™•ì •ìƒíƒœ:</label>
                    <select id="newStatusSelect" style="margin-left: 10px; padding: 6px 8px; border: 1px solid #ccc; border-radius: 6px;">
                        <option value="EXPECTED">ì´ìˆ˜ì˜ˆì •</option>
                        <option value="PENDING">íŒì •ëŒ€ê¸°</option>
                        <option value="CONFIRMED">í™•ì •</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeStatusChangeModal()">ì¼ê´„ ë³€ê²½</button>
            </div>
        </div>
    </div>

    <!-- í›ˆë ¨ìƒ ìƒì„¸ì •ë³´ ëª¨ë‹¬ -->
    <div id="traineeDetailModal" class="status-change-modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>í›ˆë ¨ìƒ ìƒì„¸ì •ë³´</h2>
                <button id="traineeDetailClose" class="modal-close" onclick="closeTraineeDetailModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="CurrentColor"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>
                </button>
            </div>
            <div class="modal-body" id="traineeDetailBody">
                <!-- JSë¡œ ë‚´ìš© ì±„ì›€ -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeTraineeDetailModal()">ì €ì¥í•˜ê¸°</button>
            </div>
        </div>
    </div>

    <script>
        // ë¹ ë¥¸ ì„ íƒ ê³¼ëª© ì¹´ë“œ ë°ì´í„° ì˜ˆì‹œ (DBì—ì„œ ë°›ì•„ì˜¨ë‹¤ê³  ê°€ì •)
        const completionList = [
            {
                checked: false,
                no: 1,
                traineeName: "ê¹€ë¯¼ìˆ˜",
                birthDate: "1996-03",
                courseName: "Java ì›¹ ê°œë°œì ê³¼ì •",
                courseBatch: "3ê¸°",
                attendanceRate: 92,
                attendanceStatus: "PASS", // PASS | WARNING | FAIL
                completionStatus: "CONFIRMED", // EXPECTED | PENDING | CONFIRMED
                finalDecision: "PASSED", // PASSED | FAILED | NONE
                confirmedDate: "2025-12-28"
            },
            {
                checked: false,
                no: 2,
                traineeName: "ì´ì§€ì€",
                birthDate: "1994-11",
                courseName: "í’€ìŠ¤íƒ ì›¹ ê°œë°œ (React & Node.js)",
                courseBatch: "3ê¸°",
                attendanceRate: 78,
                attendanceStatus: "WARNING",
                completionStatus: "CONFIRMED",
                finalDecision: "FAILED",
                confirmedDate: "2025-12-28"
            },
            {
                checked: false,
                no: 3,
                traineeName: "ë°•ì¤€í˜¸",
                birthDate: "1998-07",
                courseName: "í’€ìŠ¤íƒ ì›¹ ê°œë°œ (React & Node.js)",
                courseBatch: "1ê¸°",
                attendanceRate: 100,
                attendanceStatus: "PASS",
                completionStatus: "PENDING",
                finalDecision: "NONE",
                confirmedDate: null
            },
            {
                checked: false,
                no: 4,
                traineeName: "ìµœìœ ë‚˜",
                birthDate: "1995-01",
                courseName: "í’€ìŠ¤íƒ ì›¹ ê°œë°œ (React & Node.js)",
                courseBatch: "2ê¸°",
                attendanceRate: 85,
                attendanceStatus: "PASS",
                completionStatus: "CONFIRMED",
                finalDecision: "PASSED",
                confirmedDate: "2025-11-15"
            },
            {
                checked: false,
                no: 5,
                traineeName: "ì •í˜„ìš°",
                birthDate: "1993-09",
                courseName: "AI ì—”ì§€ë‹ˆì–´ë§",
                courseBatch: "2ê¸°",
                attendanceRate: 60,
                attendanceStatus: "FAIL",
                completionStatus: "CONFIRMED",
                finalDecision: "FAILED",
                confirmedDate: "2025-11-15"
            },
            {
                checked: false,
                no: 6,
                traineeName: "í•œì†Œì˜",
                birthDate: "1997-05",
                courseName: "AI ì—”ì§€ë‹ˆì–´ë§",
                courseBatch: "1ê¸°",
                attendanceRate: 88,
                attendanceStatus: "PASS",
                completionStatus: "EXPECTED",
                finalDecision: "NONE",
                confirmedDate: null
            }
        ];

        const completionStatusText = {
            EXPECTED: "ì´ìˆ˜ì˜ˆì •",
            PENDING: "íŒì •ëŒ€ê¸°",
            CONFIRMED: "í™•ì •"
        };

            const finalDecisionText = {
            PASSED: "ì´ìˆ˜",
            FAILED: "ë¯¸ì´ìˆ˜",
            NONE: "-"
        };

            const attendanceIcon = {
            PASS: "âœ…",
            WARNING: "âš ï¸",
            FAIL: "âŒ"
        };
        const courseCardData = [
            {
                courseId: 'course1',
                category: 'ê°œë°œ',
                status: 'ìš´ì˜ì¤‘',
                title: 'í’€ìŠ¤íƒ ì›¹ ê°œë°œ (React & Node.js)',
                instructor: 'í™ê¸¸ë™',
                subjectCount: 12,
                totalHours: 96,
                studentCount: 45,
                progress: 75,
                period: '2024-01-10 ~ 2024-06-30',
                running: true
            },
            {
                courseId: 'course2',
                category: 'ì¸ê³µì§€ëŠ¥',
                status: 'ì¢…ë£Œ',
                title: 'AI ì—”ì§€ë‹ˆì–´ë§',
                instructor: 'ê¹€ì² ìˆ˜',
                subjectCount: 10,
                totalHours: 80,
                studentCount: 30,
                progress: 100,
                period: '2023-05-01 ~ 2023-10-31',
                running: false
            }
        ];
        function renderCourseCards() {
            const list = document.getElementById('quickCourseList');
            list.innerHTML = '';
            courseCardData.forEach(card => {
                const div = document.createElement('div');
                div.className = 'quick-course-card';
                div.innerHTML = `
                    <div class="course-top-section">
                        <span class="course-category badge-kdt">${card.category}</span>
                        <div class="toggle-status">
                            <span>${card.status}</span>
                        </div>
                    </div>
                    <div class="course-header">
                        <h3 class="course-title">${card.title}</h3>
                        <span class="instructor-name">${card.instructor}</span>
                    </div>
                    <div class="course-stats">
                        <div class="stat-box"><span class="stat-text">ê³¼ëª© <strong>${card.subjectCount}</strong>ê°œ</span></div>
                        <div class="divider-vertical"></div>
                        <div class="stat-box"><span class="stat-text">ì´ <strong>${card.totalHours}</strong>ì‹œê°„</span></div>
                        <div class="divider-vertical"></div>
                        <div class="stat-box"><span class="stat-text">ìˆ˜ê°•ìƒ <strong>${card.studentCount}</strong>ëª…</span></div>
                    </div>
                    <div class="course-progress-info">
                        <div class="progress-left">
                            <span class="status-badge ${card.running ? 'status-completed' : 'status-disabled'}">${card.running ? 'ìš´ì˜ì¤‘' : 'ì¢…ë£Œ'}</span>
                            <span class="progress-period">ğŸ“… ${card.period}</span>
                        </div>
                        <span class="progress-percentage">${card.progress}%</span>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" style="width: ${card.progress}%;"></div>
                    </div>
                `;
                // ì¹´ë“œ í´ë¦­ ì‹œ ê³¼ì • ì„ íƒ select ë³€ê²½
                div.addEventListener('click', () => {
                    const courseSelect = document.getElementById('courseSelect');
                    if (courseSelect) {
                        courseSelect.value = card.courseId;
                        // íŠ¸ë¦¬ê±°: ê³¼ì • ë³€ê²½ ì‹œ í•„ìš”í•œ í•¨ìˆ˜ í˜¸ì¶œ
                            renderGraduateTable();
                    }
                });
                list.appendChild(div);
            });
        }
        // ì •ë ¬ ìƒíƒœ ë³€ìˆ˜
        let sortKey = 'name';
        let sortAsc = true;

        // ì •ë ¬ ê¸°ì¤€/ìˆœì„œ UI ì´ë²¤íŠ¸
        document.addEventListener('DOMContentLoaded', () => {
            const sortSelect = document.getElementById('sortSelect');
            const sortOrderBtn = document.getElementById('sortOrderBtn');
            const sortOrderIcon = document.getElementById('sortOrderIcon');
            if (sortSelect && sortOrderBtn && sortOrderIcon) {
                sortSelect.addEventListener('change', () => {
                    sortKey = sortSelect.value;
                    renderNameTable();
                    renderSessionTable();
                    renderStatusTable();
                });
                sortOrderBtn.addEventListener('click', () => {
                    sortAsc = !sortAsc;
                    sortOrderIcon.textContent = sortAsc ? 'â–²' : 'â–¼';
                    renderNameTable();
                    renderSessionTable();
                    renderStatusTable();
                });
            }
        });

        // ë¹ ë¥¸ ìƒíƒœë³€ê²½ ëª¨ë‹¬ ì—´ê¸°/ë‹«ê¸° í•¨ìˆ˜
        function openStatusChangeModal() {
            const modal = document.getElementById('statusChangeModal');
            if (modal) {
                modal.classList.add('show');
            }
        }

        function closeStatusChangeModal() {
            const modal = document.getElementById('statusChangeModal');
            if (modal) {
                modal.classList.remove('show');
            }
        }

        // ì¶œê²° ë°ì´í„° ì •ë ¬ í•¨ìˆ˜
        function getSortedAttendanceData(courseId) {
            if (typeof courseAttendanceData === 'undefined') return [];
            let data = (courseAttendanceData[courseId] || []).slice();
            if (sortKey === 'name') {
                data.sort((a, b) => sortAsc ? a.name.localeCompare(b.name) : b.name.localeCompare(a.name));
            } else if (sortKey === 'rate') {
                data.sort((a, b) => {
                    const aRate = parseInt(a.rate);
                    const bRate = parseInt(b.rate);
                    return sortAsc ? aRate - bRate : bRate - aRate;
                });
            } else if (sortKey === 'confirmedDate') {
                data.sort((a, b) => {
                    // null/undefined/empty string goes last
                    if (!a.confirmedDate && !b.confirmedDate) return 0;
                    if (!a.confirmedDate) return 1;
                    if (!b.confirmedDate) return -1;
                    // Compare as date string (YYYY-MM-DD)
                    if (sortAsc) {
                        return a.confirmedDate.localeCompare(b.confirmedDate);
                    } else {
                        return b.confirmedDate.localeCompare(a.confirmedDate);
                    }
                });
            }
            return data;
        }

        function renderSessionTable() {
            const courseId = document.getElementById('courseSelect').value;
            const attendanceData = getSortedAttendanceData(courseId);
            // const sessionTable = document.querySelector('#session-table');
            // if (!sessionTable) return;
            // const sessionValue = document.getElementById('sessionSelect') ? document.getElementById('sessionSelect').value : 'all';
            const sessionValue = 'all';
            let startIdx = 0, endIdx = 0, isAll = false;
            let sessionCount = attendanceData.length > 0 ? attendanceData[0].sessions.length : 0;
            if (sessionValue === 'all') {
                startIdx = 0;
                endIdx = sessionCount - 1;
                isAll = true;
            } else {
                const sessionRange = sessionValue.split('-').map(Number);
                startIdx = sessionRange[0] - 1;
                endIdx = sessionRange[1] - 1;
            }
            const thead = sessionTable.querySelector('thead');
            thead.innerHTML = '';
            const thRow = document.createElement('tr');
            for (let i = startIdx; i <= endIdx; i++) {
                const th = document.createElement('th');
                th.textContent = `ì°¨ì‹œ${i+1}`;
                thRow.appendChild(th);
            }
            thead.appendChild(thRow);
            let tbody = sessionTable.querySelector('tbody');
            if (!tbody) {
                tbody = document.createElement('tbody');
                sessionTable.appendChild(tbody);
            }
            tbody.innerHTML = '';
            attendanceData.forEach((row, idx) => {
                const tr = document.createElement('tr');
                row.sessions.slice(startIdx, endIdx+1).forEach(s => {
                    const td = document.createElement('td');
                    td.textContent = s ? 'O' : 'X';
                    tr.appendChild(td);
                });
                tr.addEventListener('mouseenter', () => handleRowHover(idx, true));
                tr.addEventListener('mouseleave', () => handleRowHover(idx, false));
                tr.addEventListener('click', () => {
                    window.location.href = 'admin-attendance-detail.html';
                });
                tbody.appendChild(tr);
            });
            // const sessionTable = document.getElementById('session-table');
            const wrapper = document.querySelector('.session-table-wrapper');
            if (isAll) {
                const minWidth = (sessionCount) * 100;
                sessionTable.style.minWidth = minWidth + 'px';
                wrapper.style.overflowX = 'auto';
            } else {
                sessionTable.style.minWidth = '';
                wrapper.style.overflowX = '';
            }
        }

        // í›ˆë ¨ìƒ ìƒì„¸ì •ë³´ ëª¨ë‹¬ ë‹«ê¸° í•¨ìˆ˜ (ì „ì—­)    
        function closeTraineeDetailModal() {
            const modal = document.getElementById('traineeDetailModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        function renderGraduateTable() {
            const tbody = document.querySelector('#graduate_table tbody');
            if (!tbody) return;
            tbody.innerHTML = '';
            // ì •ë ¬ ê¸°ì¤€ ê°€ì ¸ì˜¤ê¸°
            const sortSelect = document.getElementById('sortSelect');
            const sortKey = sortSelect ? sortSelect.value : 'name';
            let sortAsc = true;
            const sortOrderIcon = document.getElementById('sortOrderIcon');
            if (sortOrderIcon && sortOrderIcon.textContent === 'â–¼') sortAsc = false;

            // ê³¼ì • í•„í„°ë§
            const courseSelect = document.getElementById('courseSelect');
            const selectedCourse = courseSelect ? courseSelect.value : 'view-all';
            let filtered = completionList.filter(item => {
                if (selectedCourse === 'view-all') return true;
                if (selectedCourse === 'course1') return item.courseName === 'í’€ìŠ¤íƒ ì›¹ ê°œë°œ (React & Node.js)';
                if (selectedCourse === 'course2') return item.courseName === 'AI ì—”ì§€ë‹ˆì–´ë§';
                return false;
            });

            // ì •ë ¬ í•¨ìˆ˜
            let sorted = filtered.slice();
            if (sortKey === 'name') {
                sorted.sort((a, b) => sortAsc ? a.traineeName.localeCompare(b.traineeName) : b.traineeName.localeCompare(a.traineeName));
            } else if (sortKey === 'rate') {
                sorted.sort((a, b) => sortAsc ? a.attendanceRate - b.attendanceRate : b.attendanceRate - a.attendanceRate);
            } else if (sortKey === 'confirmedDate') {
                sorted.sort((a, b) => {
                    if (!a.confirmedDate && !b.confirmedDate) return 0;
                    if (!a.confirmedDate) return 1;
                    if (!b.confirmedDate) return -1;
                    return sortAsc ? a.confirmedDate.localeCompare(b.confirmedDate) : b.confirmedDate.localeCompare(a.confirmedDate);
                });
            } else if (sortKey === 'finalDecision') {
                // PASSED > FAILED > NONE
                const order = { PASSED: 0, FAILED: 1, NONE: 2 };
                sorted.sort((a, b) => sortAsc ? order[a.finalDecision || 'NONE'] - order[b.finalDecision || 'NONE'] : order[b.finalDecision || 'NONE'] - order[a.finalDecision || 'NONE']);
            } else if (sortKey === 'completionStatus') {
                // CONFIRMED > PENDING > EXPECTED
                const order = { CONFIRMED: 0, PENDING: 1, EXPECTED: 2 };
                sorted.sort((a, b) => sortAsc ? order[a.completionStatus || 'EXPECTED'] - order[b.completionStatus || 'EXPECTED'] : order[b.completionStatus || 'EXPECTED'] - order[a.completionStatus || 'EXPECTED']);
            }

            sorted.forEach((item, idx) => {
                const tr = document.createElement('tr');
                const decision = item.finalDecision || 'NONE';
                const decisionClass = decision === 'PASSED' ? 'final-passed' : decision === 'FAILED' ? 'final-failed' : '';
                const decisionText = finalDecisionText[decision] || '-';
                tr.innerHTML = `
                    <td><input type="checkbox" class="graduate-checkbox" data-index="${idx}"></td>
                    <td>${item.no}</td>
                    <td>${item.traineeName}</td>
                    <td>${item.birthDate || '-'}</td>
                    <td>${item.courseName}${item.courseBatch ? ' (' + item.courseBatch + ')' : ''}</td>
                    <td>${item.attendanceRate}%</td>
                    <td>${attendanceIcon[item.attendanceStatus] || '-'}</td>
                    <td>${completionStatusText[item.completionStatus] || '-'}</td>
                    <td><span class="${decisionClass}">${decisionText}</span></td>
                    <td>${item.confirmedDate || '-'}</td>
                    <td><button class="btn btn-gray btn-trainee-detail" data-idx="${idx}">ìˆ˜ì •í•˜ê¸°</button></td>
                `;
                tbody.appendChild(tr);
            });

            // ìƒì„¸ë³´ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸ ì—°ê²°
            tbody.querySelectorAll('.btn-trainee-detail').forEach(btn => {
                btn.addEventListener('click', function() {
                    const idx = this.getAttribute('data-idx');
                    showTraineeDetailModal(sorted[idx]);
                });
            });
                // í›ˆë ¨ìƒ ìƒì„¸ì •ë³´ ëª¨ë‹¬ í‘œì‹œ í•¨ìˆ˜
            function showTraineeDetailModal(data) {
                const modal = document.getElementById('traineeDetailModal');
                const body = document.getElementById('traineeDetailBody');
                // ì˜ˆì‹œ ë³€ê²½ë¡œê·¸ ë°ì´í„° (ì‹¤ì œë¡  ì„œë²„ì—ì„œ ë°›ì•„ì˜´)
                const changeLog = data.changeLog || [
                        {date:'2025-12-01 10:22', user:'ê´€ë¦¬ìA', reason:'ì¶œê²°ë¥  ìˆ˜ì •'},
                        {date:'2025-12-15 14:10', user:'ê´€ë¦¬ìB', reason:'ì´ìˆ˜ìƒíƒœ ìˆ˜ë™ë³€ê²½'}
                ];
                body.innerHTML = `
                        <table class="history-table" style="margin-bottom:18px;">
                            <tbody>
                                <tr><th>í›ˆë ¨ìƒëª…</th><td>${data.traineeName}</td></tr>
                                <tr><th>ìƒë…„ì›”ì¼</th><td>${data.birthDate || '-'}</td></tr>
                                <tr><th>ê³¼ì •ëª…/ê¸°ìˆ˜</th><td>${data.courseName}${data.courseBatch ? ' ('+data.courseBatch+')' : ''}</td></tr>
                                <tr><th>ì¶œê²°ë¥ (%)</th><td>${data.attendanceRate}%</td></tr>
                                <tr><th>ì´ìˆ˜ìƒíƒœ</th><td>${attendanceIcon[data.attendanceStatus] || '-'}</td></tr>
                                    <tr><th>ì´ìˆ˜í™•ì •ìƒíƒœ</th><td>
                                        <select id="manualCompletionStatusSelect">
                                            <option value="EXPECTED" ${data.completionStatus==='EXPECTED'?'selected':''}>ì´ìˆ˜ì˜ˆì •</option>
                                            <option value="PENDING" ${data.completionStatus==='PENDING'?'selected':''}>íŒì •ëŒ€ê¸°</option>
                                            <option value="CONFIRMED" ${data.completionStatus==='CONFIRMED'?'selected':''}>í™•ì •</option>
                                        </select>
                                    </td></tr>
                                <tr><th>ìµœì¢…íŒì •</th><td>
                                    <select id="manualFinalDecisionSelect">
                                        <option value="NONE" ${data.finalDecision==='NONE'?'selected':''}>-</option>
                                        <option value="PASSED" ${data.finalDecision==='PASSED'?'selected':''}>ì´ìˆ˜</option>
                                        <option value="FAILED" ${data.finalDecision==='FAILED'?'selected':''}>ë¯¸ì´ìˆ˜</option>
                                    </select>
                                </td></tr>
                                <tr><th>í™•ì •ì¼ì</th><td>${data.confirmedDate || '-'}</td></tr>
                                <tr><th>ë³€ê²½ì‚¬ìœ </th><td><input type="text" id="manualRemarkInput" value="${data.remark || ''}" style="width:100%; box-sizing:border-box; padding:4px 6px; border:1px solid #ccc; border-radius:4px;"></td></tr>
                            </tbody>
                        </table>
                        <div style="margin-bottom:8px; font-weight:600;">ë³€ê²½ë¡œê·¸</div>
                        <table class="history-table">
                            <thead><tr><th>ë³€ê²½ì¼ì‹œ</th><th>ë³€ê²½ì¸</th><th>ë³€ê²½ì‚¬ìœ </th></tr></thead>
                            <tbody>
                                ${changeLog.map(log=>`<tr><td>${log.date}</td><td>${log.user}</td><td>${log.reason}</td></tr>`).join('')}
                            </tbody>
                        </table>
                `;
                modal.style.display = 'flex';
                // ë°”ê¹¥ í´ë¦­ ì‹œ ë‹«ê¸°
                modal.onclick = e => { if(e.target===modal) modal.style.display='none'; };
            }

        

            // graduate-checkbox ì²´í¬ ì—¬ë¶€ì— ë”°ë¼ #statusChangeBtn(ì¼ê´„ ìƒíƒœë³€ê²½) í™œì„±/ë¹„í™œì„±
            function updateStatusChangeBtn() {
                const checkboxes = tbody.querySelectorAll('.graduate-checkbox');
                const anyChecked = Array.from(checkboxes).some(cb => cb.checked);
                const statusChangeBtn = document.getElementById('statusChangeBtn');
                if (statusChangeBtn) {
                    statusChangeBtn.disabled = !anyChecked;
                    if (anyChecked) {
                        statusChangeBtn.classList.remove('btn-gray-line');
                        statusChangeBtn.classList.add('btn-gray');
                    } else {
                        statusChangeBtn.classList.remove('btn-gray');
                        statusChangeBtn.classList.add('btn-gray-line');
                    }
                }
            }
            // ì²´í¬ë°•ìŠ¤ ì´ë²¤íŠ¸ ì—°ê²°
            tbody.querySelectorAll('.graduate-checkbox').forEach(cb => {
                cb.addEventListener('change', updateStatusChangeBtn);
            });
            // ì „ì²´ì„ íƒ ë²„íŠ¼ í´ë¦­ ì‹œ ì²´í¬ë°•ìŠ¤ ì „ì²´ í† ê¸€ ë° ìƒíƒœë²„íŠ¼ ê°±ì‹ 
            const selectAllBtn = document.getElementById('selectAllBtn');
            if (selectAllBtn) {
                selectAllBtn.onclick = () => {
                    const checkboxes = document.querySelectorAll('.graduate-checkbox');
                    const allChecked = Array.from(checkboxes).every(cb => cb.checked);
                    checkboxes.forEach(cb => cb.checked = !allChecked);
                    updateStatusChangeBtn();
                };
            }
            // ìµœì´ˆ ë Œë”ë§ ì‹œ ë²„íŠ¼ ë¹„í™œì„±í™”
            updateStatusChangeBtn();
        }
        document.getElementById('courseSelect').addEventListener('change', () => {
            renderGraduateTable();
        });

        document.addEventListener('DOMContentLoaded', () => {
            renderCourseCards();
            renderGraduateTable();
            const sortSelect = document.getElementById('sortSelect');
            const sortOrderBtn = document.getElementById('sortOrderBtn');
            if (sortSelect) {
                sortSelect.addEventListener('change', () => {
                    renderGraduateTable();
                });
            }
            if (sortOrderBtn) {
                sortOrderBtn.addEventListener('click', () => {
                    renderGraduateTable();
                });
            }
        });

    </script>
</body>
</html>