<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="/static/font/pretendard.css">
    <link rel="stylesheet" href="/static/css/i-common-style.css">
    <link rel="stylesheet" href="/static/css/i-sidebar-style.css">
    <link rel="stylesheet" href="/static/css/btn-style.css">
    <link rel="stylesheet" href="/static/css/dashboard.css">
    <script src="/static/js/dashboard.js" defer></script>
    <script src="/static/js/sidebar-function.js" defer></script>
    <script src="/static/js/common-funtion.js" defer></script>
    <script>
                // ê³¼ì •ë³„ ìƒìœ„ 20%/í•˜ìœ„ 30% í•™ìŠµì‹œê°„ ë¹„êµ ë°ì´í„° ìƒì„± í•¨ìˆ˜
                function generateTopBottomCodingData(courseCount = 3, studentsPerCourse = 30) {
                  let seed = 123;
                  function random() {
                    seed = (seed * 9301 + 49297) % 233280;
                    return seed / 233280;
                  }
                  const courseNames = ["í’€ìŠ¤íƒ", "ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤", "í´ë¼ìš°ë“œ"];
                  const colors = ["#B1CFEF", "#8AAEE0", "#638ECB"];
                  const data = [];
                  for (let c = 0; c < courseCount; c++) {
                    let students = [];
                    for (let i = 0; i < studentsPerCourse; i++) {
                      students.push({
                        name: `í™ê¸¸ë™${c+1}-${i+1}`,
                        coding_hour: Math.round((random() * (8 - 0.5) + 0.5) * 10) / 10
                      });
                    }
                    students.sort((a, b) => b.coding_hour - a.coding_hour);
                    const top20 = students.slice(0, Math.ceil(studentsPerCourse * 0.2));
                    const bottom30 = students.slice(-Math.ceil(studentsPerCourse * 0.3));
                    const avgTop = Math.round(top20.reduce((sum, s) => sum + s.coding_hour, 0) / top20.length * 10) / 10;
                    const avgBottom = Math.round(bottom30.reduce((sum, s) => sum + s.coding_hour, 0) / bottom30.length * 10) / 10;
                    data.push({
                      course: courseNames[c % courseNames.length],
                      color: colors[c % colors.length],
                      avgTop,
                      avgBottom
                    });
                  }
                  return data;
                }

                // ê³¼ì •ë³„ ìƒìœ„ 20%/í•˜ìœ„ 30% í•™ìŠµì‹œê°„ ë¹„êµ ë°”ì°¨íŠ¸ ë Œë”ë§ í•¨ìˆ˜
                function drawTopBottomBarChart(canvasId, data) {
                  const canvas = document.getElementById(canvasId);
                  if (!canvas) return;
                  canvas.width = 500;
                  canvas.height = 220;
                  const ctx = canvas.getContext("2d");
                  ctx.clearRect(0, 0, canvas.width, canvas.height);
                  const pad = 38;
                  const w = canvas.width, h = canvas.height;
                  const barWidth = 36;
                  const gap = 44;
                  const groupGap = 60;
                  const maxHour = Math.max(...data.map(d => Math.max(d.avgTop, d.avgBottom)), 8);
                  // yì¶•
                  ctx.strokeStyle = "#bbb";
                  ctx.lineWidth = 1;
                  for (let i = 0; i <= 4; i++) {
                    let y = h - pad - ((h - 2 * pad) * i / 4);
                    ctx.beginPath(); ctx.moveTo(pad, y); ctx.lineTo(w - pad, y); ctx.stroke();
                    ctx.fillStyle = "#888";
                    ctx.font = "11px sans-serif";
                    ctx.textAlign = "right";
                    ctx.fillText((Math.round((maxHour * i / 4) * 10) / 10) + "h", pad - 6, y + 4);
                  }
                  // xì¶• ë¼ë²¨ ë° ë°”
                  data.forEach((d, i) => {
                    const groupX = pad + i * (barWidth * 2 + gap + groupGap);
                    // top bar
                    const topBarHeight = ((d.avgTop) / maxHour) * (h - 2 * pad);
                    ctx.fillStyle = d.color;
                    ctx.globalAlpha = 0.85;
                    ctx.fillRect(groupX, h - pad - topBarHeight, barWidth, topBarHeight);
                    // bottom bar
                    const bottomBarHeight = ((d.avgBottom) / maxHour) * (h - 2 * pad);
                    ctx.fillStyle = "#E2E8F0";
                    ctx.globalAlpha = 0.95;
                    ctx.fillRect(groupX + barWidth + gap, h - pad - bottomBarHeight, barWidth, bottomBarHeight);
                    ctx.globalAlpha = 1.0;
                    // ê°’ í‘œì‹œ
                    ctx.fillStyle = "#222";
                    ctx.font = "12px sans-serif";
                    ctx.textAlign = "center";
                    ctx.fillText(d.avgTop + "h", groupX + barWidth / 2, h - pad - topBarHeight - 8);
                    ctx.fillText(d.avgBottom + "h", groupX + barWidth + gap + barWidth / 2, h - pad - bottomBarHeight - 8);
                    // xì¶• ë¼ë²¨
                    ctx.font = "13px sans-serif";
                    ctx.fillStyle = "#333";
                    ctx.fillText(d.course, groupX + barWidth + gap / 2, h - pad + 18);
                  });
                  // ë²”ë¡€
                  ctx.font = "12px sans-serif";
                  ctx.fillStyle = "#638ECB";
                  ctx.fillRect(w - pad - 120, pad + 2, 16, 16);
                  ctx.fillStyle = "#333";
                  ctx.fillText("ìƒìœ„ 20% í‰ê· ", w - pad - 98, pad + 15);
                  ctx.fillStyle = "#E2E8F0";
                  ctx.fillRect(w - pad - 120, pad + 26, 16, 16);
                  ctx.fillStyle = "#333";
                  ctx.fillText("í•˜ìœ„ 30% í‰ê· ", w - pad - 98, pad + 39);
                  // ì¶• ë¼ë²¨
                  ctx.fillStyle = "#333";
                  ctx.font = "12px sans-serif";
                  ctx.textAlign = "center";
                  ctx.fillText("í‰ê·  í•™ìŠµì‹œê°„ (h)", w / 2, h - 7);
                  ctx.save();
                  ctx.translate(14, h / 2);
                  ctx.rotate(-Math.PI / 2);
                  ctx.textAlign = "center";
                  ctx.fillText("í•™ìŠµì‹œê°„ (h)", 0, 0);
                  ctx.restore();
                  // íƒ€ì´í‹€
                  ctx.font = "bold 13px sans-serif";
                  ctx.fillStyle = "#222";
                  ctx.textAlign = "center";
                  ctx.fillText("ê³¼ì •ë³„ ìƒìœ„ 20%/í•˜ìœ„ 30% í•™ìŠµì‹œê°„ ë¹„êµ", w / 2, 20);
                }
            // ê³¼ì •ë³„ ê³¼ì œ í•´ê²° ì¶”ì´ ì‚°ì ë„ ë°ì´í„° ìƒì„± í•¨ìˆ˜
            function generateAssignmentScatterData(courseCount = 3, studentsPerCourse = 18) {
              let seed = 99;
              function random() {
                seed = (seed * 9301 + 49297) % 233280;
                return seed / 233280;
              }
              const courseNames = ["í’€ìŠ¤íƒ", "ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤", "í´ë¼ìš°ë“œ"];
              const colors = ["#B1CFEF", "#8AAEE0", "#638ECB"];
              const data = [];
              for (let c = 0; c < courseCount; c++) {
                for (let i = 0; i < studentsPerCourse; i++) {
                  data.push({
                    course: courseNames[c % courseNames.length],
                    name: `í™ê¸¸ë™${c+1}-${i+1}`,
                    coding_hour: Math.round((random() * (8 - 0.5) + 0.5) * 10) / 10,
                    solved: Math.floor(random() * 40) + 1,
                    color: colors[c % colors.length]
                  });
                }
              }
              return data;
            }

            // ê³¼ì •ë³„ ê³¼ì œ í•´ê²° ì¶”ì´ ì‚°ì ë„ ì°¨íŠ¸ ê·¸ë¦¬ê¸° í•¨ìˆ˜ (canvasId, data)
            function drawAssignmentScatterChart(canvasId, data) {
              const canvas = document.getElementById(canvasId);
              if (!canvas) return;
              canvas.width = 500;
              canvas.height = 220;
              const ctx = canvas.getContext("2d");
              ctx.clearRect(0, 0, canvas.width, canvas.height);
              const pad = 32;
              const w = canvas.width, h = canvas.height;
              const xMin = 0.5, xMax = 8, yMin = 1, yMax = 40;
              // grid
              ctx.strokeStyle = "#ddd";
              ctx.lineWidth = 1;
              for (let i = 0; i <= 4; i++) {
                let x = pad + ((w - 2 * pad) * i / 4);
                ctx.beginPath(); ctx.moveTo(x, pad); ctx.lineTo(x, h - pad); ctx.stroke();
              }
              for (let i = 0; i <= 4; i++) {
                let y = h - pad - ((h - 2 * pad) * i / 4);
                ctx.beginPath(); ctx.moveTo(pad, y); ctx.lineTo(w - pad, y); ctx.stroke();
              }
              // ì  ì°ê¸° ë° ìœ„ì¹˜ ì €ì¥
              const points = [];
              data.forEach((d, i) => {
                const x = pad + ((d.coding_hour - xMin) / (xMax - xMin)) * (w - 2 * pad);
                const y = h - pad - ((d.solved - yMin) / (yMax - yMin)) * (h - 2 * pad);
                ctx.beginPath();
                ctx.arc(x, y, 6, 0, 2 * Math.PI);
                ctx.fillStyle = d.color;
                ctx.globalAlpha = 0.85;
                ctx.fill();
                ctx.globalAlpha = 1.0;
                points.push({ x, y, r: 8, ...d });
              });
              // ì¶• ë¼ë²¨
              ctx.fillStyle = "#333";
              ctx.font = "12px sans-serif";
              ctx.textAlign = "center";
              ctx.fillText("ì½”ë”© ì‹œê°„ (ì‹œê°„)", w / 2, h - 7);
              ctx.save();
              ctx.translate(14, h / 2);
              ctx.rotate(-Math.PI / 2);
              ctx.textAlign = "center";
              ctx.fillText("í‘¼ ë¬¸ì œ ìˆ˜", 0, 0);
              ctx.restore();
              // íƒ€ì´í‹€
              ctx.font = "bold 13px sans-serif";
              ctx.fillStyle = "#222";
              ctx.textAlign = "center";
              ctx.fillText("ê³¼ì •ë³„ ê³¼ì œ í•´ê²° ì¶”ì´ (ì½”ë”©ì‹œê°„ ëŒ€ë¹„ í‘¼ ë¬¸ì œ ìˆ˜)", w / 2, 20);
              // íˆ´íŒ
              let tooltip = document.getElementById("assignmentChartTooltip");
              if (!tooltip) {
                tooltip = document.createElement("div");
                tooltip.id = "assignmentChartTooltip";
                tooltip.style.position = "fixed";
                tooltip.style.pointerEvents = "none";
                tooltip.style.background = "rgba(30,40,60,0.97)";
                tooltip.style.color = "#fff";
                tooltip.style.padding = "7px 13px";
                tooltip.style.borderRadius = "7px";
                tooltip.style.fontSize = "13px";
                tooltip.style.zIndex = 9999;
                tooltip.style.boxShadow = "0 2px 8px rgba(0,0,0,0.18)";
                tooltip.style.display = "none";
                document.body.appendChild(tooltip);
              }
              canvas.onmousemove = function(e) {
                const rect = canvas.getBoundingClientRect();
                const mx = e.clientX - rect.left;
                const my = e.clientY - rect.top;
                let found = null;
                for (let p of points) {
                  const dx = mx * (w / rect.width) - p.x;
                  const dy = my * (h / rect.height) - p.y;
                  if (dx * dx + dy * dy < p.r * p.r) {
                    found = p;
                    break;
                  }
                }
                if (found) {
                  tooltip.style.display = "block";
                  tooltip.innerHTML = `<b>${found.name}</b><br>ê³¼ì •: ${found.course}<br>ì½”ë”©ì‹œê°„: ${found.coding_hour}h<br>í‘¼ ë¬¸ì œ: ${found.solved}ê°œ`;
                  tooltip.style.left = (e.clientX + 12) + "px";
                  tooltip.style.top = (e.clientY - 10) + "px";
                } else {
                  tooltip.style.display = "none";
                }
              };
              canvas.onmouseleave = function() {
                tooltip.style.display = "none";
              };
            }
        // ê³¼ì •ë³„ ì½”ë”©ì‹œê°„ ëŒ€ë¹„ í‘¼ ë¬¸ì œ ìˆ˜ ì‚°ì ë„ ë°ì´í„° ìƒì„± í•¨ìˆ˜ (ê³µí†µ í™œìš©)
            // ê³¼ì •ë³„ ì½”ë”©ì‹œê°„ ëŒ€ë¹„ í‘¼ ë¬¸ì œ ìˆ˜ ì‚°ì ë„ ì°¨íŠ¸ ê·¸ë¦¬ê¸° í•¨ìˆ˜ (canvasId, data)
            function drawCourseScatterChart(canvasId, data) {
              const canvas = document.getElementById(canvasId);
              if (!canvas) return;
              canvas.width = 500;
              canvas.height = 220;
              const ctx = canvas.getContext("2d");
              ctx.clearRect(0, 0, canvas.width, canvas.height);
              const pad = 32;
              const w = canvas.width, h = canvas.height;
              const xMin = 0.5, xMax = 8, yMin = 1, yMax = 40;
              // grid
              ctx.strokeStyle = "#ddd";
              ctx.lineWidth = 1;
              for (let i = 0; i <= 4; i++) {
                let x = pad + ((w - 2 * pad) * i / 4);
                ctx.beginPath(); ctx.moveTo(x, pad); ctx.lineTo(x, h - pad); ctx.stroke();
              }
              for (let i = 0; i <= 4; i++) {
                let y = h - pad - ((h - 2 * pad) * i / 4);
                ctx.beginPath(); ctx.moveTo(pad, y); ctx.lineTo(w - pad, y); ctx.stroke();
              }
              // ì  ì°ê¸° ë° ìœ„ì¹˜ ì €ì¥
              const points = [];
              data.forEach((d, i) => {
                const x = pad + ((d.coding_hour - xMin) / (xMax - xMin)) * (w - 2 * pad);
                const y = h - pad - ((d.solved - yMin) / (yMax - yMin)) * (h - 2 * pad);
                ctx.beginPath();
                ctx.arc(x, y, 6, 0, 2 * Math.PI);
                ctx.fillStyle = d.color;
                ctx.globalAlpha = 0.85;
                ctx.fill();
                ctx.globalAlpha = 1.0;
                points.push({ x, y, r: 8, ...d });
              });
              // ì¶• ë¼ë²¨
              ctx.fillStyle = "#333";
              ctx.font = "12px sans-serif";
              ctx.textAlign = "center";
              ctx.fillText("ì½”ë”© ì‹œê°„ (ì‹œê°„)", w / 2, h - 7);
              ctx.save();
              ctx.translate(14, h / 2);
              ctx.rotate(-Math.PI / 2);
              ctx.textAlign = "center";
              ctx.fillText("í‘¼ ë¬¸ì œ ìˆ˜", 0, 0);
              ctx.restore();
              // íƒ€ì´í‹€
              ctx.font = "bold 13px sans-serif";
              ctx.fillStyle = "#222";
              ctx.textAlign = "center";
              ctx.fillText("ê³¼ì •ë³„ ì½”ë”©ì‹œê°„ ëŒ€ë¹„ í‘¼ ë¬¸ì œ ìˆ˜", w / 2, 20);
              // ë²”ë¡€
              const courseNames = ["í’€ìŠ¤íƒ", "ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤", "í´ë¼ìš°ë“œ"];
              const colors = ["#B1CFEF", "#8AAEE0", "#638ECB"];
              ctx.font = "12px sans-serif";
              let lx = w - pad - 80, ly = pad + 8;
              courseNames.forEach((name, i) => {
                ctx.beginPath();
                ctx.arc(lx, ly + i * 20, 6, 0, 2 * Math.PI);
                ctx.fillStyle = colors[i % colors.length];
                ctx.fill();
                ctx.fillStyle = "#333";
                ctx.fillText(name, lx + 18, ly + 4 + i * 20);
              });
              // íˆ´íŒ
              let tooltip = document.getElementById("courseChartTooltip");
              if (!tooltip) {
                tooltip = document.createElement("div");
                tooltip.id = "courseChartTooltip";
                tooltip.style.position = "fixed";
                tooltip.style.pointerEvents = "none";
                tooltip.style.background = "rgba(30,40,60,0.97)";
                tooltip.style.color = "#fff";
                tooltip.style.padding = "7px 13px";
                tooltip.style.borderRadius = "7px";
                tooltip.style.fontSize = "13px";
                tooltip.style.zIndex = 9999;
                tooltip.style.boxShadow = "0 2px 8px rgba(0,0,0,0.18)";
                tooltip.style.display = "none";
                document.body.appendChild(tooltip);
              }
              canvas.onmousemove = function(e) {
                const rect = canvas.getBoundingClientRect();
                const mx = e.clientX - rect.left;
                const my = e.clientY - rect.top;
                let found = null;
                for (let p of points) {
                  const dx = mx * (w / rect.width) - p.x;
                  const dy = my * (h / rect.height) - p.y;
                  if (dx * dx + dy * dy < p.r * p.r) {
                    found = p;
                    break;
                  }
                }
                if (found) {
                  tooltip.style.display = "block";
                  tooltip.innerHTML = `<b>${found.name}</b><br>ê³¼ì •: ${found.course}<br>ì½”ë”©ì‹œê°„: ${found.coding_hour}h<br>í‘¼ ë¬¸ì œ: ${found.solved}ê°œ`;
                  tooltip.style.left = (e.clientX + 12) + "px";
                  tooltip.style.top = (e.clientY - 10) + "px";
                } else {
                  tooltip.style.display = "none";
                }
              };
              canvas.onmouseleave = function() {
                tooltip.style.display = "none";
              };
            }
        function generateCourseCodingData(courseCount = 3, studentsPerCourse = 18) {
            let seed = 42;
            function random() {
                seed = (seed * 9301 + 49297) % 233280;
                return seed / 233280;
            }
            const courseNames = ["í’€ìŠ¤íƒ", "ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤", "í´ë¼ìš°ë“œ"];
            const colors = ["#B1CFEF", "#8AAEE0", "#638ECB"];
            const data = [];
            for (let c = 0; c < courseCount; c++) {
                for (let i = 0; i < studentsPerCourse; i++) {
                    data.push({
                        course: courseNames[c % courseNames.length],
                        name: `í™ê¸¸ë™${c+1}-${i+1}`,
                        coding_hour: Math.round((random() * (8 - 0.5) + 0.5) * 10) / 10,
                        solved: Math.floor(random() * 40) + 1,
                        color: colors[c % colors.length]
                    });
                }
            }
            return data;
        }

        // ì‚°ì ë„ ì°¨íŠ¸ ê·¸ë¦¬ê¸° í•¨ìˆ˜ (canvasId, data)
        function drawAssignmentScatterChart(canvasId, data) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            canvas.width = 500;
            canvas.height = 220;
            const ctx = canvas.getContext("2d");
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const pad = 32;
            const w = canvas.width, h = canvas.height;
            const xMin = 0.5, xMax = 8, yMin = 1, yMax = 40;
            // grid
            ctx.strokeStyle = "#ddd";
            ctx.lineWidth = 1;
            for (let i = 0; i <= 4; i++) {
                let x = pad + ((w - 2 * pad) * i / 4);
                ctx.beginPath(); ctx.moveTo(x, pad); ctx.lineTo(x, h - pad); ctx.stroke();
            }
            for (let i = 0; i <= 4; i++) {
                let y = h - pad - ((h - 2 * pad) * i / 4);
                ctx.beginPath(); ctx.moveTo(pad, y); ctx.lineTo(w - pad, y); ctx.stroke();
            }
            // ì  ì°ê¸° ë° ìœ„ì¹˜ ì €ì¥
            const points = [];
            data.forEach((d, i) => {
                const x = pad + ((d.coding_hour - xMin) / (xMax - xMin)) * (w - 2 * pad);
                const y = h - pad - ((d.solved - yMin) / (yMax - yMin)) * (h - 2 * pad);
                ctx.beginPath();
                ctx.arc(x, y, 6, 0, 2 * Math.PI);
                ctx.fillStyle = d.color;
                ctx.globalAlpha = 0.85;
                ctx.fill();
                ctx.globalAlpha = 1.0;
                points.push({ x, y, r: 8, ...d });
            });
            // ì¶• ë¼ë²¨
            ctx.fillStyle = "#333";
            ctx.font = "12px sans-serif";
            ctx.textAlign = "center";
            ctx.fillText("ì½”ë”© ì‹œê°„ (ì‹œê°„)", w / 2, h - 7);
            ctx.save();
            ctx.translate(14, h / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.textAlign = "center";
            ctx.fillText("í‘¼ ë¬¸ì œ ìˆ˜", 0, 0);
            ctx.restore();
            // íƒ€ì´í‹€
            ctx.font = "bold 13px sans-serif";
            ctx.fillStyle = "#222";
            ctx.textAlign = "center";
            ctx.fillText("ê³¼ì •ë³„ ê³¼ì œ í•´ê²° ì¶”ì´ (ì½”ë”©ì‹œê°„ ëŒ€ë¹„ í‘¼ ë¬¸ì œ ìˆ˜)", w / 2, 20);
            // íˆ´íŒ
            let tooltip = document.getElementById("assignmentChartTooltip");
            if (!tooltip) {
                tooltip = document.createElement("div");
                tooltip.id = "assignmentChartTooltip";
                tooltip.style.position = "fixed";
                tooltip.style.pointerEvents = "none";
                tooltip.style.background = "rgba(30,40,60,0.97)";
                tooltip.style.color = "#fff";
                tooltip.style.padding = "7px 13px";
                tooltip.style.borderRadius = "7px";
                tooltip.style.fontSize = "13px";
                tooltip.style.zIndex = 9999;
                tooltip.style.boxShadow = "0 2px 8px rgba(0,0,0,0.18)";
                tooltip.style.display = "none";
                document.body.appendChild(tooltip);
            }
            canvas.onmousemove = function(e) {
                const rect = canvas.getBoundingClientRect();
                const mx = e.clientX - rect.left;
                const my = e.clientY - rect.top;
                let found = null;
                for (let p of points) {
                    const dx = mx * (w / rect.width) - p.x;
                    const dy = my * (h / rect.height) - p.y;
                    if (dx * dx + dy * dy < p.r * p.r) {
                        found = p;
                        break;
                    }
                }
                if (found) {
                    tooltip.style.display = "block";
                    tooltip.innerHTML = `<b>${found.name}</b><br>ê³¼ì •: ${found.course}<br>ì½”ë”©ì‹œê°„: ${found.coding_hour}h<br>í‘¼ ë¬¸ì œ: ${found.solved}ê°œ`;
                    tooltip.style.left = (e.clientX + 12) + "px";
                    tooltip.style.top = (e.clientY - 10) + "px";
                } else {
                    tooltip.style.display = "none";
                }
            };
            canvas.onmouseleave = function() {
                tooltip.style.display = "none";
            };
        }

        // ê³¼ì •ë³„ ì§„í–‰ë¥  ëŒ€ë¹„ ì´íƒˆë¥  ë”ë¯¸ ë°ì´í„° ìƒì„±
        function generateDropoutLineData(courseCount = 3, points = 7) {
            let seed = 77;
            function random() {
                seed = (seed * 9301 + 49297) % 233280;
                return seed / 233280;
            }
            const courseNames = ["í’€ìŠ¤íƒ", "ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤", "í´ë¼ìš°ë“œ"];
            const colors = ["#B1CFEF", "#8AAEE0", "#638ECB"];
            let data = [];
            for (let i = 0; i < courseCount; i++) {
                let arr = [];
                for (let j = 0; j < points; j++) {
                    // ì§„í–‰ë¥ : 0~100% êµ¬ê°„
                    const progress = Math.round((j / (points - 1)) * 100);
                    // ì´íƒˆë¥ : 0~20% ì‚¬ì´ ëœë¤
                    const dropout = Math.round((random() * 15 + i * 2) * 10) / 10;
                    arr.push({ progress, dropout });
                }
                data.push({ name: courseNames[i], color: colors[i % colors.length], arr });
            }
            return data;
        }

        // êº¾ì€ì„ ê·¸ë˜í”„ ê·¸ë¦¬ê¸° í•¨ìˆ˜ (canvasId, data)
        function drawDropoutLineChart(canvasId, data) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            canvas.width = 500;
            canvas.height = 220;
            const ctx = canvas.getContext("2d");
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const pad = 38;
            const w = canvas.width, h = canvas.height;
            // ì¶•
            ctx.strokeStyle = "#bbb";
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                let y = h - pad - ((h - 2 * pad) * i / 5);
                ctx.beginPath(); ctx.moveTo(pad, y); ctx.lineTo(w - pad, y); ctx.stroke();
            }
            for (let i = 0; i <= 5; i++) {
                let x = pad + ((w - 2 * pad) * i / 5);
                ctx.beginPath(); ctx.moveTo(x, pad); ctx.lineTo(x, h - pad); ctx.stroke();
            }
            // ë°ì´í„°
            const xMin = 0, xMax = 100, yMin = 0, yMax = 25;
            // ë¼ì¸ ë° ì 
            data.forEach((course, idx) => {
                ctx.strokeStyle = course.color;
                ctx.lineWidth = 2.2;
                ctx.beginPath();
                course.arr.forEach((pt, i) => {
                    const x = pad + ((pt.progress - xMin) / (xMax - xMin)) * (w - 2 * pad);
                    const y = h - pad - ((pt.dropout - yMin) / (yMax - yMin)) * (h - 2 * pad);
                    if (i === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                });
                ctx.stroke();
                // ì 
                course.arr.forEach((pt, i) => {
                    const x = pad + ((pt.progress - xMin) / (xMax - xMin)) * (w - 2 * pad);
                    const y = h - pad - ((pt.dropout - yMin) / (yMax - yMin)) * (h - 2 * pad);
                    ctx.beginPath();
                    ctx.arc(x, y, 5, 0, 2 * Math.PI);
                    ctx.fillStyle = course.color;
                    ctx.globalAlpha = 0.9;
                    ctx.fill();
                    ctx.globalAlpha = 1.0;
                });
            });
            // ì¶• ë¼ë²¨
            ctx.fillStyle = "#333";
            ctx.font = "12px sans-serif";
            ctx.textAlign = "center";
            ctx.fillText("ì§„í–‰ë¥ (%)", w / 2, h - 7);
            ctx.save();
            ctx.translate(14, h / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.textAlign = "center";
            ctx.fillText("ì´íƒˆë¥ (%)", 0, 0);
            ctx.restore();
            // íƒ€ì´í‹€
            ctx.font = "bold 13px sans-serif";
            ctx.fillStyle = "#222";
            ctx.textAlign = "center";
            ctx.fillText("ê° ê³¼ì • ì§„í–‰ë¥  ëŒ€ë¹„ ì´íƒˆë¥ ", w / 2, 20);
            // ë²”ë¡€
            ctx.font = "12px sans-serif";
            let lx = w - pad - 80, ly = pad + 8;
            data.forEach((course, i) => {
                ctx.beginPath();
                ctx.arc(lx, ly + i * 20, 6, 0, 2 * Math.PI);
                ctx.fillStyle = course.color;
                ctx.fill();
                ctx.fillStyle = "#333";
                ctx.fillText(course.name, lx + 18, ly + 4 + i * 20);
            });
            // íˆ´íŒ
            let tooltip = document.getElementById("dropoutChartTooltip");
            if (!tooltip) {
                tooltip = document.createElement("div");
                tooltip.id = "dropoutChartTooltip";
                tooltip.style.position = "fixed";
                tooltip.style.pointerEvents = "none";
                tooltip.style.background = "rgba(30,40,60,0.97)";
                tooltip.style.color = "#fff";
                tooltip.style.padding = "7px 13px";
                tooltip.style.borderRadius = "7px";
                tooltip.style.fontSize = "13px";
                tooltip.style.zIndex = 9999;
                tooltip.style.boxShadow = "0 2px 8px rgba(0,0,0,0.18)";
                tooltip.style.display = "none";
                document.body.appendChild(tooltip);
            }
            // ì  hover
            const points = [];
            data.forEach((course) => {
                course.arr.forEach((pt) => {
                    const x = pad + ((pt.progress - xMin) / (xMax - xMin)) * (w - 2 * pad);
                    const y = h - pad - ((pt.dropout - yMin) / (yMax - yMin)) * (h - 2 * pad);
                    points.push({ x, y, r: 8, name: course.name, ...pt });
                });
            });
            canvas.onmousemove = function(e) {
                const rect = canvas.getBoundingClientRect();
                const mx = e.clientX - rect.left;
                const my = e.clientY - rect.top;
                let found = null;
                for (let p of points) {
                    const dx = mx * (w / rect.width) - p.x;
                    const dy = my * (h / rect.height) - p.y;
                    if (dx * dx + dy * dy < p.r * p.r) {
                        found = p;
                        break;
                    }
                }
                if (found) {
                    tooltip.style.display = "block";
                    tooltip.innerHTML = `<b>${found.name}</b><br>ì§„í–‰ë¥ : ${found.progress}%<br>ì´íƒˆë¥ : ${found.dropout}%`;
                    tooltip.style.left = (e.clientX + 12) + "px";
                    tooltip.style.top = (e.clientY - 10) + "px";
                } else {
                    tooltip.style.display = "none";
                }
            };
            canvas.onmouseleave = function() {
                tooltip.style.display = "none";
            };
        }

        document.addEventListener("DOMContentLoaded", function() {
            // ë”ë¯¸ ë°ì´í„° ìƒì„± ë° ì°¨íŠ¸ ê·¸ë¦¬ê¸°
            // ì‹œí—˜ íŒ¨ë„: ê¸°ì¡´ ì‚°ì ë„/êº¾ì€ì„ ê·¸ë˜í”„ ìœ ì§€
            const examData = generateCourseCodingData(3, 18);
            drawCourseScatterChart("assignmentTrendChart", examData);
            const dropoutData = generateDropoutLineData(3, 7);
            drawDropoutLineChart("examTrendChart", dropoutData);
  
            // ê³¼ì œ íŒ¨ë„: ìƒìœ„ 20%/í•˜ìœ„ 30% í•™ìŠµì‹œê°„ ë¹„êµ ë°”ì°¨íŠ¸ë¡œ ë³€ê²½
            const topBottomData = generateTopBottomCodingData(3, 30);
            drawTopBottomBarChart("supportTrendChart", topBottomData);
        });
    </script>
    <title>Samsung Academy LXP - ê°•ì‚¬</title>
    <style>
        /* ì¶”ê°€ì ì¸ í˜ì´ì§€ë³„ ìŠ¤íƒ€ì¼ì€ ì—¬ê¸°ì— ì‘ì„± */
    </style>
</head>
<body>
    <!-- ìƒë‹¨ í—¤ë” -->
    <header class="header">
        <h1>ëŒ€ì‹œë³´ë“œ</h1>
        <!-- icon -->
        <div class="icon-container">
            <div class="icon-box"><a href="/templates/instructor/alarm.html"><img src="/static/icons/bell.svg" alt="alert icon" style="width: 28px;"></a></div>
            <div class="icon-box" onClick="location.href='/templates/instructor/my-info.html'"><img src="/static/icons/user.svg" alt="user icon" style="width: 30px;"></div>
            <div class="icon-box"><img src="/static/icons/setting.svg" alt="setting icon" style="width: 25px;"></div>
        </div>
    </header>

    <!-- ì™¼ìª½ ì‚¬ì´ë“œë°” -->
    <aside class="sidebar">
        <!-- ì‚¬ì´ë“œë°” ë©”ë‰´ ë‚´ìš© -->

        <!-- logo-box -->
        <div class="logo-box">
            <img id="sidebarLogo" src="/static/img/logo-white.png" alt="logo" style="width: 130px;">
        </div>

        <!-- menu -->
        <nav class="menu">
            <ul>
                <li onclick="handleMenuClick(this, 'index.html')">
                    <img src="/static/icons/01-dashboard.svg" alt="dashboard icon" style="width: 26px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ëŒ€ì‹œë³´ë“œ</span>
                </li>
                <li onclick="handleMenuClick(this, 'trainees.html')">
                    <img src="/static/icons/02-user.svg" alt="trainee icon" style="width: 28px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">í›ˆë ¨ìƒ</span>
                </li>
                <li onclick="handleMenuClick(this, 'contents.html')">
                    <img src="/static/icons/03-description.svg" alt="contents icon" style="width: 26px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ì½˜í…ì¸ </span>
                </li>
                <li onclick="handleMenuClick(this, 'courses.html')">
                    <img src="/static/icons/03-course.svg" alt="course icon" style="width: 25px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ë‹´ë‹¹ ê³¼ì •</span>
                    <ul>
                        <a href="/templates/instructor/courses.html"><li>ê³¼ì • ê´€ë¦¬</li></a>
                        <a href="/templates/instructor/scheduler.html"><li>ì¼ì • ê´€ë¦¬</li></a>
                    </ul>
                </li>
                <li onclick="handleMenuClick(this, 'assignment.html')">
                    <img src="/static/icons/04-evaluation.svg" alt="evaluation icon" style="width: 28px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">í‰ê°€</span>
                    <ul>
                        <a href="/templates/instructor/assignment.html"><li>ê³¼ì œ ì±„ì </li></a>
                        <a href="/templates/instructor/result.html"><li>ì‹œí—˜ ì±„ì </li></a>
                        <a href="/templates/instructor/proctor/exams.html"><li>í‰ê°€ ëª¨ë‹ˆí„°ë§</li></a>
                    </ul>
                </li>
                <li onclick="handleMenuClick(this, '/templates/instructor/attendance.html')">
                    <img src="/static/icons/05-attendance.svg" alt="attendance icon" style="width: 28px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ì¶œê²°/ì´ìˆ˜ ê´€ë¦¬</span>
                    <ul>
                        <a href="/templates/instructor/attendance.html"><li>ì¶œê²°í˜„í™©</li></a>
                        <a href="/templates/instructor/graduate.html"><li>ì´ìˆ˜ ê´€ë¦¬</li></a>    
                    </ul>
                </li>
                <li onclick="handleMenuClick(this, 'notices.html')">
                    <img src="/static/icons/06-support.svg" alt="communication icon" style="width: 28px; margin-right: 8px; vertical-align: middle; padding-bottom: 4px;">
                    <span class="menu-text">ì†Œí†µ</span>
                    <ul>
                        <a href="/templates/instructor/notices.html"><li>ê³µì§€ì‚¬í•­</li></a>
                        <a href="/templates/instructor/tutoring.html"><li>íŠœí„°ë§/Q&A</li></a>
                    </ul>
                </li>
            </ul>
        </nav>
        <span class="logout" onclick="location.href='../01-login/login.html'">ë¡œê·¸ì•„ì›ƒ 
            <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px" fill="CurrentColor">
                <path d="M186.67-120q-27 0-46.84-19.83Q120-159.67 120-186.67v-586.66q0-27 19.83-46.84Q159.67-840 186.67-840h292.66v66.67H186.67v586.66h292.66V-120H186.67Zm470.66-176.67-47-48 102-102H360v-66.66h351l-102-102 47-48 184 184-182.67 182.66Z"/>
            </svg>
        </span>
    </aside>

    <!-- í† ê¸€ ë²„íŠ¼ -->
    <div class="toggle-btn" onclick="toggleSidebar()">
        â—€
    </div>
    <!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
    <main class="main-content">
    <section class="main-content-inner">
      <div class="dashboard-wrap">
        <!-- Header -->
        <div class="dash-header">
          <div class="dash-title">
            <h2 id="helloTitle">ğŸ‘‹ ê°•ì‚¬ë‹˜, ì˜¤ëŠ˜ë„ ìˆ˜ê³  ë§ìœ¼ì„¸ìš”</h2>
            <p>ì˜¤ëŠ˜ í•´ì•¼ í•  ì—…ë¬´ì™€ ë‹´ë‹¹ ê³¼ì • í˜„í™©ì„ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”.</p>
          </div>
          <div class="dash-date" id="todayText">ì˜¤ëŠ˜: -</div>
        </div>

        <!-- KPI -->
        <div class="kpi-grid">
          <div class="kpi-card">
            <div class="kpi-top">
              <div class="kpi-label">ğŸ“ ë¯¸ì±„ì  ê³¼ì œ</div>
              <div class="kpi-value" id="kpiAssignment">0ê±´</div>
            </div>
            <div class="kpi-sub">ì±„ì ì´ í•„ìš”í•œ ê³¼ì œê°€ ìˆì–´ìš”</div>
            <div class="kpi-actions">
              <button class="btn btn-primary" type="button" onclick="location.href='/templates/instructor/assignment.html'">ì±„ì í•˜ê¸°</button>
            </div>
          </div>

          <div class="kpi-card">
            <div class="kpi-top">
              <div class="kpi-label">ğŸ§ª ë¯¸ì±„ì  ì‹œí—˜</div>
              <div class="kpi-value" id="kpiExam">0ê±´</div>
            </div>
            <div class="kpi-sub">ì‹œí—˜ ì±„ì  ëŒ€ê¸° í•­ëª©ì´ ìˆì–´ìš”</div>
            <div class="kpi-actions">
              <button class="btn btn-primary" type="button" onclick="location.href='/templates/instructor/result.html'">ì±„ì í•˜ê¸°</button>
            </div>
          </div>

          <div class="kpi-card">
            <div class="kpi-top">
              <div class="kpi-label">ğŸ’¬ ë¯¸ì‘ë‹µ ë¬¸ì˜</div>
              <div class="kpi-value" id="kpiSupport">0ê±´</div>
            </div>
            <div class="kpi-sub">íŠœí„°ë§/QnA ë‹µë³€ì´ í•„ìš”í•´ìš”</div>
            <div class="kpi-actions">
              <button class="btn btn-primary" type="button" onclick="location.href='/templates/instructor/tutoring.html'">ì‘ë‹µí•˜ê¸°</button>
            </div>
          </div>

          <div class="kpi-card">
            <div class="kpi-top">
              <div class="kpi-label">ğŸ¥ ê°ë… ì¤‘ ì‹œí—˜</div>
              <div class="kpi-value" id="kpiProctor">0ê±´</div>
            </div>
            <div class="kpi-sub">ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§/ë…¹í™” í™•ì¸</div>
            <div class="kpi-actions">
              <button class="btn btn-primary" type="button" onclick="location.href='/templates/instructor/proctor/exams.html'">ëª¨ë‹ˆí„°ë§</button>
            </div>
          </div>
        </div>

        <!-- 2x2 panels -->
        <div class="panel-grid">
          <!-- Row 1 -->
          <div class="panel-row-1">
            <!-- Courses -->
            <div class="panel">
              <div class="panel-header">
                <h3>ğŸ“š ë‹´ë‹¹ ê³¼ì • ìš”ì•½</h3>
                <button class="btn btn-gray" type="button" onclick="location.href='/templates/instructor/courses.html'">ì „ì²´ë³´ê¸°</button>
              </div>
              <div class="panel-body">
                <div class="list" id="courseList">
                  <!-- JS render -->
                </div>
              </div>
            </div>

            <!-- Today's Evaluation -->
            <div class="panel">
              <div class="panel-header">
                <h3>ğŸ§ª ì˜¤ëŠ˜ì˜ í‰ê°€ ì—…ë¬´</h3>
                <button class="btn btn-gray" type="button" onclick="location.href='/templates/instructor/result.html'">ì±„ì ëª©ë¡</button>
              </div>
              <div class="panel-body">
                <div class="list" id="todayEvalList">
                  <!-- JS render -->
                </div>
              </div>
            </div>
          </div>

          <!-- Row 2 -->
          <div class="panel-row-2">
            <!-- Support -->
            <div class="panel">
              <div class="panel-header">
                <h3>ğŸ’¬ ì‘ë‹µí˜„í™© (íŠœí„°ë§/QnA)</h3>
                <button class="btn btn-gray" type="button" onclick="location.href='/templates/instructor/tutoring.html'">ì „ì²´ë³´ê¸°</button>
              </div>
              <div class="panel-body">
                <div class="list" id="supportList">
                  <!-- JS render -->
                </div>
              </div>
            </div>

            <!-- Proctor -->
            <div class="panel">
              <div class="panel-header">
                <h3>ğŸ¥ ì‹œí—˜ ê°ë… / ëª¨ë‹ˆí„°ë§</h3>
                <button class="btn btn-gray" type="button" onclick="location.href='/templates/instructor/proctor/exams.html'">ì „ì²´ë³´ê¸°</button>
              </div>
              <div class="panel-body">
                <div class="list" id="proctorList">
                  <!-- JS render -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="panel-triple">
          <div class="panel-grid-3" style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
            <!-- ê³¼ì œ í•´ê²° ì¶”ì´ -->
            <div class="panel">
              <div class="panel-header">
                <h3>ğŸ“ˆ ê³¼ì •ë³„ ê³¼ì œ í•´ê²° ì¶”ì´</h3>
              </div>
              <div class="panel-body">
                <canvas id="assignmentTrendChart" style="width: 100%; height: 220px;"></canvas>
              </div>
            </div>
            <!-- ì‹œí—˜ í•´ê²° ì¶”ì´ -->
            <div class="panel">
              <div class="panel-header">
                <h3>ğŸ§ª ê° ê³¼ì • ì§„í–‰ë¥  ëŒ€ë¹„ ì´íƒˆë¥  ì¶”ì´</h3>
              </div>
              <div class="panel-body">
                <canvas id="examTrendChart" style="width: 100%; height: 220px;"></canvas>
              </div>
            </div>
            <!-- ë¬¸ì˜ í•´ê²° ì¶”ì´ -->
            <div class="panel">
              <div class="panel-header">
                <h3>ğŸ’¬ í•™ìŠµì‹œê°„ ë¹„êµê·¸ë˜í”„</h3>
              </div>
              <div class="panel-body">
                <canvas id="supportTrendChart" style="width: 100%; height: 220px;"></canvas>
              </div>
            </div>
          </div>
          
        </div>

        <!-- Notice -->
        <div class="panel">
          <div class="panel-header">
            <h3>ğŸ“Œ ê³µì§€ / ì•Œë¦¼</h3>
            <button class="btn btn-gray" type="button" onclick="location.href='/templates/admin/admin-07-notice/admin-notice.html'">ì „ì²´ë³´ê¸°</button>
          </div>
          <div class="panel-body">
            <div class="note-list" id="noticeList">
              <!-- JS render -->
            </div>
          </div>
        </div>

      </div>
    </section>
    </main>

</body>
</html>
